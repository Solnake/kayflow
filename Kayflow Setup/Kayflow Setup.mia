Comment
Comment
Code Folding Region
Get System Settings
If
MessageBox
Terminate Install
End
Get System Settings
If
MessageBox
Terminate Install
End
Get System Settings
If
MessageBox
Terminate Install
End
Code Folding Region
Set Variable
Get System Settings
GoTo Label
Comment
Code Folding Region
Code Folding Region
Label
Comment
Set Variable
Set Variable
Compiler Variable If
If
Set Variable
Set Variable
End
If
Include Script
Include Script
If
Include Script
End
Include Script
Include Script
Include Script
Else
Include Script
Include Script
If
Include Script
End
Include Script
Include Script
Include Script
End
Compiler Variable End
Code Folding Region
Comment
Code Folding Region
Comment
If
Display Dialog
If
Terminate Install
End
Display Dialog
Compiler Variable If
If
Set Variable
Set Variable
(Un)Install MSI Setup
If
MessageBox
Terminate Install
End
If
MessageBox
If
Reboot and Resume
Else
Terminate Install
End
End
Set Variable
End
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Web Media Block
Include Script
Compiler Variable End
Hide Dialog
End
Code Folding Region
Comment
Code Folding Region
GoTo Label
Comment
Code Folding Region
Label
Comment
Define Component
Define Component
Comment
Comment
Get System Settings
Get Folder Location
Get Folder Location
Get Folder Location
Get Folder Location
If
Set Variable
End
Get Folder Location
Get Folder Location
Get Folder Location
Get Folder Location
Get Folder Location
Code Folding Region
Comment
Code Folding Region
If
GoTo Label
Else
Compiler Variable If
Comment
Set Variable
Set Variable
Compiler Variable End
End
Comment
Label
Display Dialog
If
GoTo Label
End
Compiler Variable If
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Comment
If
Set Component State
Else
If
Set Component State
Set Component State
End
End
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Get Component State
GoTo Label
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Label
Display Dialog
If
GoTo Label
Else
If
GoTo Label
End
End
Compiler Variable End
Label
Display Dialog
If
Compiler Variable If
GoTo Label
Compiler Variable Else
GoTo Label
Compiler Variable End
Else
GoTo Label
End
Comment
Label
Comment
Wizard Loop
Display Dialog
Display Dialog
Display Dialog
End
Code Folding Region
Get Component State
GoTo Label
Comment
Code Folding Region
Label
Comment
If
Terminate Install
End
Comment
Comment
Set Variable
Set Variable
Set Variable
If
Set Variable
Else
Set Variable
End
Display Dialog
Comment
Comment
Code Folding Region
If
Comment
Comment
Apply Changes
Set Variable
Else
Code Folding Region
Code Folding Region
Comment
Create Shortcut
Web Media Block
Web Media Block
If
End
Web Media Block
If
End
Web Media Block
If
End
Install Files
Install Files
Web Media Block
Get Component State
If
End
Web Media Block
Get Component State
If
Install Files
Create Shortcut
Create Shortcut
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
Install Files
End
Comment
Compiler Variable If
Apply Patch
Compiler Variable Else
If
Apply Changes
Else
Apply Changes
If
If
Get Component State
If
End
If
End
Get Component State
If
Set Variable
MS SQL Server
If
MS SQL Server
End
MS SQL Server
MS SQL Server
End
End
End
End
Compiler Variable End
Set Variable
End
Code Folding Region
Code Folding Region
Comment
Code Folding Region
Comment
Hide Dialog
Display Dialog
If
If
If
Reboot Computer
End
End
If
If
If
Run Program
Comment
End
End
End
End
Code Folding Region
Comment
$
{EAC2DE05-46D6-41BA-B560-3179A7A6D24D}
{6261E7EF-F237-429B-AF18-7AD3D1D79D07}
{C6F54FCE-3880-470E-9428-6756901A6FC8}
{02EA5EB0-011E-41C9-90DA-1DB32BB41174}
{3905944C-EDD9-4791-88BB-9FE0FB4DC095}
{EF0BB50E-97F5-4356-A705-3F7C35770FEE}
{1B3BC1FF-63CD-4FCB-A9F7-9288BFDA7EFA}
{5DCFB2C3-B59D-4061-8F1E-08F5710B0D25}
{A4A9D66D-7BD5-41BA-8B2A-2AA1C4C62371}
{62963E8E-6185-4872-9E90-1748A2FEE47D}
{1BBD44CB-B596-4CAD-8485-9F124D688323}
{D0C59098-AB45-458B-89FF-06D9157A2687}
{CA03D1E1-ED61-4624-97C0-265405C84759}
{2CD8B713-0D9B-4D3E-854E-91D78DBF6F53}
{680F5AAE-0811-43C6-AC21-EFFDB0312BCD}
{BD177271-4C59-4D6B-8BA5-FC8B6C7CC02E}
{18163B58-5EE1-4B46-BECC-169FA198C7FC}
{E97D3A71-562A-41FC-B50F-380FC5BBC818}
{B37E8D3C-5B33-49A1-B45C-3F99CFCBAFE1}
{271F70DD-DA29-4B9A-BC87-60EC6EA02BD4}
{C327EA80-B1B3-42DD-AD14-C3BC061F17EF}
{22790FBB-C1F8-466B-967C-9ED0FDB8A0DB}
{5F4C0516-7B62-4A21-8DAF-6BFB014A03D7}
{0A59C938-16CA-42E1-B59D-91A6748D8C8B}
{60AFFCD3-CD57-41B9-83D6-EE8DE765ED05}
{174E2598-A14C-4720-B92F-E16601DE8F87}
{87B363CB-E027-4610-BF4A-B28EB6D2FD1A}
{DA9F655F-1EAB-414E-9BDF-F9E5F189345E}
{C70F53D1-AC10-4E01-B3E8-F2F4CDDA637C}
{0EC7DFAD-8849-467F-BFE7-0E1963882F7C}
{F4D29B13-89F6-479B-9BD9-3C932A27F1B0}
{EA7601D0-ECA7-4313-8034-D75F7BDCDAA6}
{54DCBB23-72A8-41F8-BB33-8CE9EF82FD64}
{A02EB79E-4DC5-4B9F-99C8-F70F34C4D325}
{DF389046-613A-4DEB-805B-33D3A39BF438}
{56E3FC3F-7983-49EB-8687-3207F487E83B}
{7840A11A-DF32-40EC-8CBD-8766BEFC18ED}
{F97F0D25-AF9F-46B7-ADEB-9AEABA8D713B}
{7038CD66-8AB4-4446-8C4F-39121DFA60F0}
{6D4642D7-C566-4A93-812B-FE8CD6213544}
{97EFC3CE-38D0-4FFE-B027-B1A38C951C55}
{52F73CCB-8B96-4193-AE30-653BCE9CB80E}
{3F756C5D-B5A1-4ACB-AC58-D3EDDE26DA29}
{D52AB394-FAED-4E01-A311-8536CB8DCEE9}
{E103A153-29A1-4B79-8610-B846AC963A5A}
{5076CE5F-FFCF-4767-A57B-22790961D758}
{CE7EDA89-32F6-48AE-B631-E50D64C54739}
{CAC72F59-8DDB-4794-8446-10B1E682FD41}
{0FEF00F9-A040-4B1C-A2A9-651D5FCD938A}
{14157B79-8B34-4379-95F7-4A81CA0DAEF6}
{60211926-F64C-4258-874C-E73A23F0B39B}
{0642013C-9A18-4C1C-B870-7E4BFD1EF5AA}
{F813AC53-BA4A-429E-8C61-2C1035AF42D2}
{306417AC-9301-4AB6-AAEE-D574DF58631B}
{10079D54-AA1F-4FAC-B112-2854EB4EA88B}
{E2AF7D07-BC4C-462A-9882-C3B6116BF241}
{B5D8B434-CC05-4D81-B859-0491F832E933}
{C085E2DA-33FF-4A07-89A3-3AE7AC481B56}
{67F71290-8DB7-4AD1-BC24-2FE88E8615E1}
{62A10A11-DFCB-4443-A579-B3967D6A3428}
{CD07F5AE-A2A0-4017-BEED-562FAB1A7514}
{764BB777-BFCA-4E3C-AE85-BBEBFCDB7381}
{4E72AC1D-0D1D-425F-8859-5B83443343DE}
{FF9E03FC-F5BC-46B2-8AB0-98F649F99846}
{4F6B74D8-5F5D-4C81-BB2C-EAE24B0A3A4A}
{FFA3C065-B0EA-4956-A59E-93A4A5E6A821}
{B29D0ED1-9170-478C-8554-FDB436C09450}
{9DA41D74-A1DB-434E-AB96-EF57E5225725}
{1F768BF6-D273-4B4D-A3C2-B801C83B561A}
{7F18EE79-36A9-47A6-9C75-C190F30B6C77}
{DADDEFCA-F388-4463-BB73-BA8E76CE1C1C}
{B07CF752-7C00-4671-994C-45E33DBB4B8B}
{545816CE-2408-4C0D-A72E-67F440D03DEC}
{14A32B98-97F5-4FC5-AB26-48CC962655ED}
{DE2A4CC3-D30D-4504-A09E-4855D3EE10B3}
{C07F93BF-27FC-407C-8691-9DBBF43E9293}
{2C404403-0729-4C8F-BD69-F5BFDDBCA663}
{8F9FCBB2-E1D2-4D71-AFAC-7CC7743F4377}
{CCB845BD-DC67-496B-A0AE-E1D5BFED7707}
{9F7FFE83-404B-4376-A7EA-4341FAC0C91E}
{2FA63A8B-DE43-4F62-86AD-2A417289846E}
{FE6C9AE8-04E9-472C-AFFA-9854B1A04FF8}
{B2020CBE-8C49-4673-AB70-78F3021D1027}
{AD29C018-75A8-4642-9551-C0EAB47AA5CE}
{ABF21893-5283-4988-8052-FEA4EEE2B95D}
{5F34B2D8-FB5F-4164-9CF5-F18A1B662B1C}
{A4550364-49D0-434E-ACA1-A8F4D8EF1540}
{867159BE-1B8C-4CF1-B8C1-94E610D1AAC4}
{86B0FA72-F5FE-4332-A0AD-96644D84213F}
{99B0B55F-68EE-4D47-A97A-9A35805DE091}
{71B2885B-CF14-4A21-9653-90784F426969}
{92BBD091-C74A-4FAB-BBDF-5DB382FF1C58}
{88CD9AC1-C903-4BA0-ADB9-31A7D43D2C09}
{1CA462E6-0345-4A9C-A9A2-3FCAE5A48573}
{9AAE3148-2B3D-4EE8-ABBC-33C6DFC20800}
{46D716DB-8E10-4E68-845B-2D7BA1504695}
{8FE60F7A-1477-4E26-A84C-711867D7C3E9}
{F2E84EF8-E882-46E6-9ABE-891926BCA930}
{663C87B4-3BE0-4199-80ED-E8B5B32B88F1}
{158BC420-5E72-44CE-A2DC-BA0386A68A96}
{FB647C04-9BCD-45F2-BA69-7770A2FC1155}
{3A7CA02C-037B-42DA-B953-288984635A3D}
{8DE23E78-79ED-4799-88A2-F40AE7A686AD}
{6A848332-44E8-478B-9D30-37BCA3EC10A3}
{5451B114-E7A1-4729-940B-6D96F225A37C}
{CD0EF23F-53A8-47DF-BF96-7A289F282E0F}
{08492AF4-04CD-4A90-AB89-DFC5184A30DF}
{B829B73F-ADF4-4392-AB10-DF388AFD4DA5}
{22D6BD75-F814-42F3-A43C-1AF9F6425DED}
{B98C91B4-9E5A-42AD-98D2-71C82FD4B48F}
{AD5551D4-41F5-484F-9909-2CE6E9740F97}
{B76B10B6-2B16-4AF8-BD5A-CF8C7F484F01}
{D99F2709-85B2-46B0-BF24-6555B143CDFA}
{A7B78857-BA77-489C-BDAA-57B5195A7A3F}
{67780C6A-1812-4E8D-9805-1AA495997A76}
{03329F88-256D-4A7C-A2EC-1F0FF96EF854}
{8FDFB0CC-90F5-45EB-BF8A-23A39DC76593}
{3F7D30AF-4E8F-4F6A-BF21-5E347D2BD9CA}
{B2219B27-6920-4A4D-B37D-6B468B320A0E}
{AA49038D-3C0C-43BD-AE8C-7EB5E6A708CE}
{E310B51D-5167-48AB-BD90-E20C159979EA}
{F0EFDCDD-B744-4C8D-BE3A-739B86A98503}
{DBD1453B-0D03-4D2D-80BD-447CF649D4DB}
{0BF82EE1-11C5-4BE4-B434-7CD594FBBD3E}
{5D4AFC8F-942F-469A-BFEE-8CA1993EAC4D}
{BDA5187E-4E79-4675-A820-D59C82BA2FF9}
{BF6469EA-508A-4A77-BEB5-5A8541ABE33C}
{DF79B055-79EB-4665-A0E7-B4FD4E3398B9}
{C00C71C6-B039-4789-8BEA-6B2058819A58}
{5EA8C7D9-A76E-4915-B795-99BFF4467A6A}
{DD868BCC-7077-4D82-B8C5-4B3C484242CC}
{0600792A-6B5C-4EAE-B1C9-AA13790F33A1}
{893B9AE2-F992-482F-B0F9-88CCBA97E290}
{DCAB2EC0-F475-4675-B652-3E5325A4DFAC}
{2D6AD537-DE1D-4217-9A99-06EF14EC759A}
{C0F4EA2F-7785-4C00-A3CA-1CA80B710FA8}
{5F9C8F69-4C9E-4253-9CD3-0A559133A04F}
{9B7B44A8-3F31-4B8E-8424-602DCA3138C8}
{5DF6E92E-52AA-4DEC-8849-C4675F5F8E09}
{76D78A98-1A7B-4C67-AABE-1D7C813F63BA}
{F926C67A-3F17-4DC5-B308-8F2BB6000DBE}
{BB69F235-F7D0-421E-8781-902EABBE65E3}
{7943297D-FD53-480B-8288-5BE6AFCA6ABD}
{95B6825E-F918-4223-9381-41D650E8ABF1}
{6F2496E3-A514-4859-B8E7-83EB9691CE79}
{A9164296-D175-402F-8342-CCCC0060A7E0}
{3C65B346-2CE1-467C-91C3-BE9C0C135272}
{0EA4D345-0EFE-4DA5-9CC1-11AC96351255}
{7006227C-D2E4-4E44-A465-1F78FC0F9331}
{8479925B-7CE6-411C-AED9-E850F6283262}
{B7E39EB6-1EC2-4A85-B467-915746BFE066}
{9B488B67-DBC6-4D9D-ADCE-98E0497602C7}
{C2245A8F-395E-4D49-AF41-6B995B6BC349}
{3B96945D-D68E-46B8-8079-DA777154E646}
{B22A7D47-41AA-4D51-A551-1D28C99445A1}
{29F173AD-8856-440C-BCB9-7C4B7D847B3A}
{3FC102C8-4468-4955-BE51-BC4DA8293CE7}
{54C2DF6A-9A93-4D09-9BB9-7B35C0D631A9}
{5C198BB7-8D76-4DF8-AEF3-234C16406D76}
{FB887FB3-561C-497A-B175-4993C60EB6E7}
{5FD91CE4-E6A4-495D-BA0C-2305B5A68C9D}
{08A23460-CFEC-40BE-834B-6B8AB7A66BD3}
{7F8B486C-2E9B-4EE2-AC95-197849CA6A6B}
{366641E3-4716-4F20-8D81-6A8F686E59E7}
{C1A69B15-A05C-4892-8208-434F6BD83E66}
{BAD6FE63-2119-42F9-962A-FF65036EE4D4}
{58FC6E63-B35D-4DB3-BDB7-19A157F454F6}
{8D011262-BAB6-4A04-B9C4-9389A22DAE8B}
{C69FAB28-77BE-460C-8CBF-66C22B78EF2D}
{2675BA1F-B54F-417A-826E-1ECE9BDB4A82}
{0882B0A0-1A75-4B7A-A264-904131B268D3}
{E1B40B95-8ADF-46F6-A421-D42E0C3786D6}
{90577090-D6E1-4E78-8852-5A9BE874DFE3}
{ADCBF0AF-781D-4B57-BEA1-7CCBC57C0D29}
{C0228CDA-BD29-4BF8-A7E8-32715A444647}
{1BAEC6DB-3159-4EC1-879B-977829BC3D63}
{AD39150E-83AF-484D-A709-FEE89D267C19}
{2E93DAB7-4543-41E2-8149-2708EACD9C3C}
{7F129379-E841-45B9-B3B3-5A84C830C727}
{8412A46F-1B42-4EED-9365-81796F6EA0DA}
{24A28B6E-A1DF-4783-BA23-89CAFED45CEC}
{EC7108B6-8BC7-419A-B2D6-10D235B4D095}
{C6FC307B-BDEF-4B8D-9694-DDFB3C0FC423}
{CFDB194F-4A44-4F11-9260-C94F5A1813DF}
{84037274-3C8E-4FF5-82F6-9585E1C6E024}
{A139B289-A928-41DD-B8DF-721C183018E8}
{F09E3DA1-B4CB-43A8-BD2D-1FE8DA1D00D4}
{C864BA01-3F00-4541-8379-B9B0F468B264}
{F176A21A-86D9-46DD-9443-7192016D495F}
{50945126-8F54-470C-838A-B22F1CD17208}
{F09CD733-AEEA-463E-8828-5388781DB798}
{971513A9-AEE8-4FC7-83C2-D7B1FF46BD42}
{97394A9B-D514-4C0C-9DEE-DE192DD78465}
{53806157-44B8-445F-81FB-22D3F53B5B56}
{37989525-9363-4BC6-AB17-2FB1BE9EDFD6}
{37A0EFA7-1495-47AC-8AC2-FD29C287E95B}
{DB71424D-95D7-4BC1-9EAD-C8630824420D}
{2CDAD5D6-E5D4-4ABD-A7E6-513A9D7EE3EC}
{3638BF4D-D7D0-4F40-A205-F786B338B733}
{9741C910-28BF-4359-B231-DF71CCDDAFBA}
{53174ED0-D6F7-4112-85BB-1F15BFEA41B6}
{717FABE2-BDF5-4C82-A0B6-137C10CCC0F6}
{5A15DCDA-E423-4904-A869-5C3ECA4E34F6}
{94CE1D3E-31A3-49D2-9342-BA50FCB573B4}
{E5FDC407-2DBF-49FA-A74D-22A6D6B4DA7D}
{AD24B0CF-2B67-475C-A854-3E8BDE831E9F}
{0B0EBD91-678F-45E5-A8CD-29240382D4F8}
{FCED9E24-6CAA-48D6-87DF-198949137E82}
{0360AE00-70A5-49F0-8CE2-603C531DA51A}
{6DBB38A4-7C60-4A7E-B3B2-C9FD55656F88}
{52A570A6-D570-467D-8DE3-10E00F76FDCB}
{E2A0CA5E-B2B7-4FF5-A7CF-AE522F9318B7}
{4747603E-A322-48BF-84B6-9204F913DFB0}
{7DACEA2C-15B4-4B9E-87C4-48AF57C6453E}
{06D7C51C-2911-4170-82AF-CFEDEBAFA062}
{7DA81B2B-7610-4515-B5C5-ADF7E782377F}
{0490A26A-DD0F-401C-94EB-05C6A2FDDD81}
{4E947B51-9CD8-4899-B218-905D840B5E08}
{8AB9EF38-EFBE-4A7F-A770-EFB82003C87F}
{1366CF31-782B-48F2-A4F7-E2A106EA0BA8}
{4B286534-89CD-4A41-80DB-29851A754EC3}
{BCBDE971-B09D-4E89-964C-E8AC4EBC5C73}
{C8A5D5EC-E51F-45CE-986B-86403D63A333}
{82AD749A-15F8-4E72-A05D-545418F9079F}
{1DA86C79-FBCF-4062-95C5-6C935D0FADCC}
{25AA65F2-6762-4E64-99B8-D6B5D8D89A68}
{1121F050-A565-4FCF-A53A-FB342A012889}
{26965319-C802-4C18-A049-A8BCBD7F0BB7}
{41D45201-D129-43E0-B0AA-88543120D3DB}
{DBB4F1D4-6977-4F5C-B824-B79CD6727BC5}
{1A9CA9B0-776B-41AF-8193-9DB27B9E5090}
{09560685-7210-4589-BCCE-3AFE1C7E5CCB}
{ECE2F2E9-1E65-4E07-BE93-7DB18843BD17}
{3AE3B77A-1DF6-4F40-9C8C-EFB3E7CE0D05}
{95DDDA45-CE94-4798-8529-BA315859B249}
{6674254F-54B7-452F-ACCC-F55CE4422EF5}
{69E5F0D1-0A1D-4730-8014-67E89D22A303}
{EDC3A744-7E11-4140-AD1E-95895C92D9B7}
{C52E3680-DD65-4F7F-94F0-26E1174B8022}
{1A85D9B7-6162-41E3-98BA-1C57BA525288}
{9E06B112-A71D-4BA7-BC4D-92A209503265}
{8A5D7829-F22D-4893-9C12-F2C0536F1E6A}
{B4847DE0-81CD-4281-AD3D-5C50DC963AA4}
{59466456-7B5A-4455-9AB9-AAA08A5D297F}
{B74B2505-9027-4858-872D-3D5189C9BBD7}
{D44BA038-FF86-4004-B8CA-03C2DB2083CE}
{A8A33330-FB07-46FE-B6F3-0AE06D913F3E}
{8D904CC3-E8A3-4910-82D1-512C008DF28E}
{954AABE5-724A-40D8-91E4-32C21FD4A999}
{52159E1C-1E02-42F8-9A63-CB69ED887041}
{A379953D-7F91-4BDE-9D98-747D04DCF432}
{873573BF-CA60-4079-AC6C-03A8AF1FDBC9}
{DC1CBA9F-9117-4BDC-AB77-229803DFC5DD}
{8BE2B44F-0039-4095-BF92-AEE41E0C8ED6}
{2C7B0EB6-E46E-4AE2-8545-5F1FE96ACC53}
{38B75497-3CE8-40EA-86B8-EF1846134FF5}
{0B3C9EAA-BA84-4DCA-9A90-97EE32EDCF7F}
{F73F1B36-7005-4254-B469-F601B5247D4F}
{81811FEF-3D2B-46D4-8EE1-D039AEBB6058}
{50DD569B-0AD0-4640-A2FF-D9F2D234A78E}
{2ED2C483-242C-4E20-B562-E3D69653F1F0}
{0EDA6791-D63B-43EF-820E-98A4F128BF66}
{EDA58E8B-27AD-4792-AFE2-91819E09018B}
{F510BF3C-72BE-4266-A671-1817CF4D7942}
{2794914F-A9FB-4B30-8B7F-46A6847C1AD8}
{226B8D75-1432-46D1-A435-11E8A7052083}
{2649B137-CDD0-4763-8FCA-57A1CA2BA1FC}
{10D3B148-0E11-4C79-BEA4-FC6145F77C69}
{B44683BC-C622-47C9-97DF-F96E69DFFBB3}
{AE448B68-2010-4C56-B7A6-D5E6239AE1C7}
{F5CE3CFF-8AAD-4012-B707-A82880AFF666}
{6B622BEA-C0E0-4619-B876-AEECC1F5F6A3}
{FE657500-8F42-4C46-9DE6-A7C626A223DC}
{65EA7076-E5D2-4AFF-BFAE-C3C252A2C90B}
{9A2F2B53-B8B7-41BF-8E09-1955DA8EC2B4}
{F03393A3-4C41-417D-B313-866876674256}
{47515BE9-CE96-431E-B2A7-3A64BA52FB05}
{EC6F1653-ED42-4C81-B458-139A0794705E}
{1915FFEF-8678-40EB-BC0E-16F3BA3DFCA7}
{0CD0DEDD-0A2D-4E75-9AFB-1BA139A7CB80}
{67D8142E-B8BE-4BC3-91FD-B63EC3F054F5}
{557271C4-AECC-47ED-921E-4272F269F2DB}
{0E01D807-304D-4267-A06E-D2D68678C4E8}
{D4553F20-3B33-4231-A250-87831F5CF056}
{EDB64F22-1428-43F3-99A6-A73B65A02689}
{BF1393AF-B7AA-4457-B7C9-121A8BA586A9}
{F0722378-0EB7-4570-9BBA-0B66F5757333}
{CC375DED-A7EB-4107-A66C-31539EEFB187}
{C108D041-90DA-4BCD-B3B1-B058C59BBABE}
{B1F01A20-23E3-455E-9878-F539EC32540F}
{F32ABD6D-84CD-4113-99E1-14F77A64CC21}
{20A82265-5F28-49EC-B779-DBB05D7C7459}
{5E55CD9B-DF99-42B1-9728-58B79556B55C}
{D7872541-36A0-4952-BF4B-5E5E77F45C75}
{22A67D00-39AA-42BB-ABED-AD2669104C3E}
{2723D348-3FD0-440A-B02E-58DDADDF7D78}
{547BB9FB-6E5A-4D7F-ACA7-2DFE0AB54E01}
{D8C40A99-3075-46D3-8DF9-00906B333182}
{767DB89D-6C0F-4DB4-9D20-AE6A518439E3}
{5560AA96-0C52-4590-8A3C-DA4F9BB427E6}
{0B2E13C2-0650-4A6A-864F-B7947474F7D1}
{D1427698-43EC-4DEE-9991-2CB03E0041C6}
{EB9EE30D-1EE3-4E7C-A575-A12BAB17D070}
{778FC5E2-8E15-454B-8FFF-65F2107F85B5}
{ED9EE93C-E491-4030-9A84-FFEFFBD02AE2}
{06B312E0-A751-4879-9479-69A0EDC0DD66}
{BBAE92F0-0AB4-4A47-BE58-35DC215406E0}
{D3317497-1196-4C16-8F4F-3C7869EEF187}
{C15EF379-B7B6-4CBA-8F69-1202EBCE14CF}
{8734F36F-3F6B-4B72-9563-5F1488B0B00D}
{DE042479-67D5-4C6F-A106-255606A54C3C}
{AAB6CED0-4678-4253-A062-131D5CD9EE85}
{EFF2E1BD-16B3-4FCC-A04C-AE9039E1A244}
{BB457A6B-7311-4D74-A430-ED14A0822C99}
{934826ED-00BA-4611-A65F-171E5EAEFECA}
{2D201526-F91E-40B5-A7D6-7C816D65D93E}
{AF9B840C-4EFD-4F4E-8604-D268D9D1B439}
{DF77485F-1782-4018-A1FE-EAFD73A0FD1C}
{73CAB6C4-102B-49B6-9F20-51B339271D51}
{2663798C-D08A-4D2E-8BA4-3F7A30CE8CEF}
{83539FBE-50C7-40EB-949D-83F47167F9E9}
{1BCE1C29-5763-4A41-A341-C241D462FAE7}
{A9A9787C-A510-45BB-9758-146ABAC81937}
{F30096B7-867C-46F1-8BEF-8063B6B9AAD9}
{33C956F1-61D4-45F0-8B89-DBF853B0D9DA}
{B61BEC7D-A9F7-42AC-AA43-512CE03768B8}
{388C18B1-4474-4E81-814E-9DDE99E0FA81}
{860C21D0-FDD3-4D47-A3EE-2337F2FE9F01}
{D399CD08-97DD-4755-B43C-E6C7AA7AE896}
{220F8AC8-2650-4337-B6B1-4B3E295AB291}
{77DEC4DC-8358-4C0D-A876-5A33A5ECC6F8}
{6AB062D4-FE52-4598-944D-19A2FF006F5C}
{D3686FDA-D87B-4488-A354-8AA387F73F8E}
{E6B00FDE-3209-4245-AE35-C986864DD8C0}
{5A3B06B6-DDA2-4EED-ADA9-5BCE8136A7A4}
{84495438-CE72-4E84-AEC6-AB85D4462CC4}
{7A772195-8F75-4D37-983F-6F8465DF6D64}
{41B1A0DB-C962-4C39-8DE9-FB7FB1055652}
{3306DD02-FB68-41B0-B4FD-18D1C5C625BA}
{303CB56C-01E3-4A18-8778-D8FB79B225CA}
{48447C8C-51F7-49E6-A9FD-FAE987B6E55C}
{88057FF5-2185-4BE0-937A-ABBBC9929161}
{E4DCF368-E072-41D4-A31D-175B4CD43BCD}
{9E21F94A-2E33-48D4-8F32-6D8F1D35979D}
{FBA83632-8B5D-4BC8-850B-E159183932C3}
{CEFC4A34-1FD3-4B2B-9A7F-65CC1E371427}
{41F11A39-9756-489C-A559-E50D46822CC4}
{440A167A-327F-4651-BBCE-79E6163194B8}
{E14D1117-F0B0-4961-A38F-92667178420C}
{D1CABA7D-F2AA-431F-9EC6-91D0F1018DDF}
{EFE3842E-724F-4492-848D-974B3A4D3922}
{094F314E-0D87-4857-A917-980282D0C449}
{DCA43E12-87F9-454A-B133-8BE5B1FE8EAB}
{B5BB452E-208D-4D61-BBAB-96FA07FBD467}
{32E83325-BA5A-4B03-AF1A-CC9DE703BA9A}
{B652D13E-AE92-4542-80D8-14FF680EF875}
{FD6BEA29-9D71-437A-A64D-E798FE87D58F}
{4A91C199-FE08-464A-8C63-92FA8A286C95}
{766EE872-397B-44D8-BEDD-21FD09568D64}
{0064BC0E-AE08-404A-8115-C3C88646E130}
{566FCF19-241A-4F9F-A0A3-595A5D57037F}
{217C71ED-A54B-4943-955B-DD4CBF6C7D8B}
{0C6F3D70-3AF2-45A7-9EE2-94085F62BB86}
{03F23362-5475-4B70-A556-1C8D504E2AB2}
{EE708104-B758-48DD-8521-A896FD519649}
{1C10C8E5-9720-4058-A929-2289098EB32F}
{64B26EDC-422F-4A32-B313-103443F0F72C}
{03E19ECB-9A3C-4160-88B5-AC6ECD6F2B4D}
{65B527E5-8D93-4C85-BBC2-DE6FA30F8D59}
{30CAD748-88B0-4FD2-998B-8039A415480C}
{44AA0002-6027-44AA-A4F1-3DA831FA3285}
{A000708A-119A-44F6-A84B-3BF3BBBB78A9}
{BBD26FF5-04E4-4A0D-832F-3D7276F868C0}
{3B20D68A-0D55-4F19-A2CE-714BA01EE9A9}
{ED60816E-C5D5-4004-838F-BE7CA24A6154}
{F9BA8B7F-5A9D-4775-BBDF-9030338A3D03}
{AE16A41A-C856-4919-A3BB-3BBAE807EEB6}
{D06D5377-D13E-459C-B6A0-D8D0E4CEBEDE}
{15D2C589-D340-4D04-91BB-40E30862CECA}
{B45552AA-1DF5-4B26-BEA4-2FD31BF04BBF}
{DA9570ED-5267-4A85-B4C5-D079A371EC37}
{F4D56350-9290-42D6-8630-CA0F7A1568D7}
{F8181CF3-E043-41BB-97CA-53B3DE538E3B}
{1BFD0B0B-3477-4773-8530-2AA737B77E7E}
{F78CAE2B-6E5D-4EA3-9860-9E922BA20CC7}
{08CB0BAA-03F6-4971-A669-D1AD423F9D9E}
$
{EAC2DE05-46D6-41BA-B560-3179A7A6D24D}
.NET Application Setup Project
{6261E7EF-F237-429B-AF18-7AD3D1D79D07}

{5F4C0516-7B62-4A21-8DAF-6BFB014A03D7}

{D99F2709-85B2-46B0-BF24-6555B143CDFA}

{03329F88-256D-4A7C-A2EC-1F0FF96EF854}
Define Setup Components
{B2219B27-6920-4A4D-B37D-6B468B320A0E}

{AA49038D-3C0C-43BD-AE8C-7EB5E6A708CE}
Initialize Setup Globals
{2D6AD537-DE1D-4217-9A99-06EF14EC759A}

{F926C67A-3F17-4DC5-B308-8F2BB6000DBE}
First Time Install
{A9164296-D175-402F-8342-CCCC0060A7E0}

{F176A21A-86D9-46DD-9443-7192016D495F}
TO-DO: Customize your minimum setup here
{C52E3680-DD65-4F7F-94F0-26E1174B8022}

{9E06B112-A71D-4BA7-BC4D-92A209503265}
Maintenance Install/Uninstall
{52159E1C-1E02-42F8-9A63-CB69ED887041}

{DC1CBA9F-9117-4BDC-AB77-229803DFC5DD}
Exit Setup if Wizard Loop cancelled
{0B3C9EAA-BA84-4DCA-9A90-97EE32EDCF7F}

{F73F1B36-7005-4254-B469-F601B5247D4F}
Prepare to install
{10D3B148-0E11-4C79-BEA4-FC6145F77C69}

{B44683BC-C622-47C9-97DF-F96E69DFFBB3}
Modify Target System
{6B622BEA-C0E0-4619-B876-AEECC1F5F6A3}
Uninstall product
{FE657500-8F42-4C46-9DE6-A7C626A223DC}
TO-DO: Insert any additional uninstall commands here
{1915FFEF-8678-40EB-BC0E-16F3BA3DFCA7}
Install/Re-Install product
{6AB062D4-FE52-4598-944D-19A2FF006F5C}
TO-DO: Insert any additional install commands here
{08CB0BAA-03F6-4971-A669-D1AD423F9D9E}

{B45552AA-1DF5-4B26-BEA4-2FD31BF04BBF}
TO-DO: Insert command that starts your application here
{64B26EDC-422F-4A32-B313-103443F0F72C}
End of Installation
{EE708104-B758-48DD-8521-A896FD519649}

{B98C91B4-9E5A-42AD-98D2-71C82FD4B48F}

{C085E2DA-33FF-4A07-89A3-3AE7AC481B56}
Install setup pre-requisites
{E2AF7D07-BC4C-462A-9882-C3B6116BF241}

{87B363CB-E027-4610-BF4A-B28EB6D2FD1A}
Check setup pre-requisites
{BF6469EA-508A-4A77-BEB5-5A8541ABE33C}
SHORTCUTFILESALL
$SHORTCUTFILES$
{81811FEF-3D2B-46D4-8EE1-D039AEBB6058}
PROGRESSTEXT
Installing $TITLE$
{50DD569B-0AD0-4640-A2FF-D9F2D234A78E}
SUCCESS

{2ED2C483-242C-4E20-B562-E3D69653F1F0}
LASTERROR

{EDA58E8B-27AD-4792-AFE2-91819E09018B}
SHORTCUTFOLDER
$SHORTCUTFILESALL$\$STARTMENU$
{2794914F-A9FB-4B30-8B7F-46A6847C1AD8}
SHORTCUTFOLDER
$SHORTCUTFILES$\$STARTMENU$
{9A2F2B53-B8B7-41BF-8E09-1955DA8EC2B4}
PROGRESS
100
{566FCF19-241A-4F9F-A0A3-595A5D57037F}
PROGRESS
100
{FE6C9AE8-04E9-472C-AFFA-9854B1A04FF8}
MAINTENANCE
FALSE
{9DA41D74-A1DB-434E-AB96-EF57E5225725}
ERROROLD

{B29D0ED1-9170-478C-8554-FDB436C09450}
REMOVEOLD

{54DCBB23-72A8-41F8-BB33-8CE9EF82FD64}
PRELIST
$PRELIST$$NEWLINE$Previous Version Uninstallation
{EA7601D0-ECA7-4313-8034-D75F7BDCDAA6}
PREREQ
TRUE
{C70F53D1-AC10-4E01-B3E8-F2F4CDDA637C}
PRELIST

{DA9F655F-1EAB-414E-9BDF-F9E5F189345E}
PREREQ
FALSE
{7943297D-FD53-480B-8288-5BE6AFCA6ABD}
STARTMENU
$TITLE$
{BB69F235-F7D0-421E-8781-902EABBE65E3}
TARGETDIR
$PROGRAMFILES$\$TITLE$
{271F70DD-DA29-4B9A-BC87-60EC6EA02BD4}
INSTALLSERVER$MYAH$MYAH$FALSE
FALSE
{E14D1117-F0B0-4961-A38F-92667178420C}
DBEXISTS$MYAH$MYAH$FALSE

{BDA5187E-4E79-4675-A820-D59C82BA2FF9}
SHORTCUTFILESALL
0

FALSE
{5F9C8F69-4C9E-4253-9CD3-0A559133A04F}
MAINTENANCE
0
TRUE
FALSE
{76D78A98-1A7B-4C67-AABE-1D7C813F63BA}
BUILDMODE
0
PATCH
TRUE
{7006227C-D2E4-4E44-A465-1F78FC0F9331}
WIZARD
0
CANCEL
FALSE
{9B488B67-DBC6-4D9D-ADCE-98E0497602C7}
BUILDMODE
0
PATCH
TRUE
{B22A7D47-41AA-4D51-A551-1D28C99445A1}
WIZARD
0
BACK
FALSE
{54C2DF6A-9A93-4D09-9BB9-7B35C0D631A9}
WIZARD
0
CANCEL
FALSE
{366641E3-4716-4F20-8D81-6A8F686E59E7}
WIZARD
0
BACK
FALSE
{58FC6E63-B35D-4DB3-BDB7-19A157F454F6}
WIZARD
0
CANCEL
FALSE
{90577090-D6E1-4E78-8852-5A9BE874DFE3}
WIZARD
0
BACK
FALSE
{1BAEC6DB-3159-4EC1-879B-977829BC3D63}
WIZARD
0
CANCEL
FALSE
{EC7108B6-8BC7-419A-B2D6-10D235B4D095}
WIZARD
0
BACK
FALSE
{84037274-3C8E-4FF5-82F6-9585E1C6E024}
WIZARD
0
CANCEL
FALSE
{50945126-8F54-470C-838A-B22F1CD17208}
MINIMUM
0
TRUE
FALSE
{97394A9B-D514-4C0C-9DEE-DE192DD78465}
COMPLETE
0
TRUE
FALSE
{9741C910-28BF-4359-B231-DF71CCDDAFBA}
WIZARD
0
BACK
FALSE
{5A15DCDA-E423-4904-A869-5C3ECA4E34F6}
WIZARD
0
CANCEL
FALSE
{52A570A6-D570-467D-8DE3-10E00F76FDCB}
WIZARD
0
BACK
FALSE
{7DACEA2C-15B4-4B9E-87C4-48AF57C6453E}
WIZARD
0
CANCEL
FALSE
{1366CF31-782B-48F2-A4F7-E2A106EA0BA8}
WIZARD
0
BACK
FALSE
{C8A5D5EC-E51F-45CE-986B-86403D63A333}
WIZARD
0
CANCEL
FALSE
{DBB4F1D4-6977-4F5C-B824-B79CD6727BC5}
WIZARD
0
BACK
FALSE
{1A9CA9B0-776B-41AF-8193-9DB27B9E5090}
BUILDMODE
0
PATCH
TRUE
{8BE2B44F-0039-4095-BF92-AEE41E0C8ED6}
WIZARD
0
CANCEL
FALSE
{0EDA6791-D63B-43EF-820E-98A4F128BF66}
ALLUSERS
0
TRUE
FALSE
{F5CE3CFF-8AAD-4012-B707-A82880AFF666}
REMOVE
0
TRUE
FALSE
{767DB89D-6C0F-4DB4-9D20-AE6A518439E3}
SELECTED
0
TRUE
FALSE
{D3686FDA-D87B-4488-A354-8AA387F73F8E}
BUILDMODE
0
PATCH
FALSE
{84495438-CE72-4E84-AEC6-AB85D4462CC4}
ADVERTISE
0
TRUE
FALSE
{D06D5377-D13E-459C-B6A0-D8D0E4CEBEDE}
SUCCESS
0
COMPLETE
FALSE
{AE16A41A-C856-4919-A3BB-3BBAE807EEB6}
REMOVE
0
FALSE
FALSE
{F9BA8B7F-5A9D-4775-BBDF-9030338A3D03}
RUNAPP
0
TRUE
FALSE
{A000708A-119A-44F6-A84B-3BF3BBBB78A9}
SUCCESS
0
REBOOT
FALSE
{44AA0002-6027-44AA-A4F1-3DA831FA3285}
REBOOTCOMPUTER
0
TRUE
FALSE
{30CAD748-88B0-4FD2-998B-8039A415480C}
SILENT
0
FALSE
FALSE
{C07F93BF-27FC-407C-8691-9DBBF43E9293}
REBOOTNOW
0
OK
FALSE
{14A32B98-97F5-4FC5-AB26-48CC962655ED}
REMOVEOLD
0
REBOOT
FALSE
{7F18EE79-36A9-47A6-9C75-C190F30B6C77}
REMOVEOLD
0
ERROR
FALSE
{FFA3C065-B0EA-4956-A59E-93A4A5E6A821}
NEEDSUPGRADE
0
TRUE
FALSE
{4F6B74D8-5F5D-4C81-BB2C-EAE24B0A3A4A}
BUILDMODE
0
PATCH
TRUE
{CD07F5AE-A2A0-4017-BEED-562FAB1A7514}
WIZARD
0
CANCEL
FALSE
{67F71290-8DB7-4AD1-BC24-2FE88E8615E1}
PREREQ
0
FALSE
TRUE
{F4D29B13-89F6-479B-9BD9-3C932A27F1B0}
NEEDSUPGRADE
0
TRUE
FALSE
{0EC7DFAD-8849-467F-BFE7-0E1963882F7C}
BUILDMODE
0
PATCH
TRUE
{680F5AAE-0811-43C6-AC21-EFFDB0312BCD}
CHECKSYSTEM
0
TRUE
TRUE
{0E01D807-304D-4267-A06E-D2D68678C4E8}
SELECTED
0
TRUE
FALSE
{BF1393AF-B7AA-4457-B7C9-121A8BA586A9}
SELECTED
0
TRUE
FALSE
{303CB56C-01E3-4A18-8778-D8FB79B225CA}
SUCCESS
0
ERROR
TRUE
{48447C8C-51F7-49E6-A9FD-FAE987B6E55C}
SUCCESS
0
CANCEL
TRUE
{E4DCF368-E072-41D4-A31D-175B4CD43BCD}
SELECTED
0
TRUE
FALSE
{C108D041-90DA-4BCD-B3B1-B058C59BBABE}
SELECTED
0
TRUE
FALSE
{FBA83632-8B5D-4BC8-850B-E159183932C3}
SELECTED
0
TRUE
FALSE
{62963E8E-6185-4872-9E90-1748A2FEE47D}
CHECKSYSTEM
0
TRUE
TRUE
{22A67D00-39AA-42BB-ABED-AD2669104C3E}
SELECTED
0
TRUE
FALSE
{440A167A-327F-4651-BBCE-79E6163194B8}
SELECTED
0
TRUE
FALSE
{3905944C-EDD9-4791-88BB-9FE0FB4DC095}
CHECKSYSTEM
0
TRUE
TRUE
{DF389046-613A-4DEB-805B-33D3A39BF438}
IS64
0
TRUE
FALSE
{F97F0D25-AF9F-46B7-ADEB-9AEABA8D713B}
INSTALLSERVER
0
TRUE
FALSE
{CE7EDA89-32F6-48AE-B631-E50D64C54739}
INSTALLSERVER
0
TRUE
FALSE
{EFE3842E-724F-4492-848D-974B3A4D3922}
DBEXISTS
0
SUCCESS
TRUE
{DE2A4CC3-D30D-4504-A09E-4855D3EE10B3}
$TITLE$ Setup
Your computer needs to be restarted before $TITLE$ Setup can continue.$NEWLINE$$NEWLINE$Please save your work in all running programs and click OK to restart your computer. Setup will resume once your computer restarts.$NEWLINE$$NEWLINE$If you click CANCEL, setup will exit. You will have to run setup again at a later time to install $TITLE$.
2
2
REBOOTNOW
{DADDEFCA-F388-4463-BB73-BA8E76CE1C1C}
$TITLE$ Setup
Unable to uninstall old version of $TITLE$. Please uninstall it yourself using Control Panel Add-Remove Programs before attempting to install this product.$NEWLINE$$NEWLINE$$ERROROLD$
2
1

{BD177271-4C59-4D6B-8BA5-FC8B6C7CC02E}
$TITLE$ Setup Error
This product requires at least Windows XP.$NEWLINE$$NEWLINE$Setup cannot continue.
3
1

{1BBD44CB-B596-4CAD-8485-9F124D688323}
$TITLE$ Setup Error
This product requires at least Administrator Privileges.$NEWLINE$$NEWLINE$Setup cannot continue.
3
1

{EF0BB50E-97F5-4356-A705-3F7C35770FEE}
$TITLE$ Setup Error
This product requires at least Internet Explorer 6.0 Service Pack 1.$NEWLINE$$NEWLINE$Setup cannot continue.
3
1

{0EA4D345-0EFE-4DA5-9CC1-11AC96351255}
welcome
WIZARD
TRUE

TRUE
FALSE
{3B96945D-D68E-46B8-8079-DA777154E646}
licensecheck
WIZARD
TRUE

TRUE
FALSE
{7F8B486C-2E9B-4EE2-AC95-197849CA6A6B}
readme
WIZARD
TRUE

TRUE
FALSE
{E1B40B95-8ADF-46F6-A421-D42E0C3786D6}
registration
WIZARD
TRUE

TRUE
FALSE
{24A28B6E-A1DF-4783-BA23-89CAFED45CEC}
setuptype
WIZARD
TRUE

TRUE
FALSE
{3638BF4D-D7D0-4F40-A205-F786B338B733}
componentstree
WIZARD
TRUE
PERSONALIZED
TRUE
FALSE
{6DBB38A4-7C60-4A7E-B3B2-C9FD55656F88}
destination
WIZARD
TRUE

TRUE
FALSE
{8AB9EF38-EFBE-4A7F-A770-EFB82003C87F}
startmenu
WIZARD
TRUE

TRUE
FALSE
{41D45201-D129-43E0-B0AA-88543120D3DB}
startinstallation
WIZARD
TRUE

TRUE
FALSE
{B4847DE0-81CD-4281-AD3D-5C50DC963AA4}
maintenance
WIZARD
TRUE

TRUE
FALSE
{59466456-7B5A-4455-9AB9-AAA08A5D297F}
componentstree
WIZARD
TRUE
MODIFY
TRUE
FALSE
{B74B2505-9027-4858-872D-3D5189C9BBD7}
startinstallation
WIZARD
TRUE

TRUE
FALSE
{2649B137-CDD0-4763-8FCA-57A1CA2BA1FC}
progress
WIZARD
FALSE

TRUE
FALSE
{65B527E5-8D93-4C85-BBC2-DE6FA30F8D59}
finish
WIZARD
TRUE

TRUE
FALSE
{FF9E03FC-F5BC-46B2-8AB0-98F649F99846}
progressprereq
WIZARD
FALSE

TRUE
FALSE
{62A10A11-DFCB-4443-A579-B3967D6A3428}
prereq
WIZARD
TRUE

TRUE
FALSE
{3F7D30AF-4E8F-4F6A-BF21-5E347D2BD9CA}
Kayflow Client
TRUE
Установка клиентской части
{8FDFB0CC-90F5-45EB-BF8A-23A39DC76593}
Kayflow Server
TRUE
Установка сервера баз данных
{F09CD733-AEEA-463E-8828-5388781DB798}
Kayflow Server
FALSE
{37989525-9363-4BC6-AB17-2FB1BE9EDFD6}
Kayflow Client
TRUE
{53806157-44B8-445F-81FB-22D3F53B5B56}
Kayflow Server
TRUE
{D8C40A99-3075-46D3-8DF9-00906B333182}
Kayflow Client
SELECTED
{88057FF5-2185-4BE0-937A-ABBBC9929161}
Kayflow Client
SELECTED
{D7872541-36A0-4952-BF4B-5E5E77F45C75}
Kayflow Server
SELECTED
{41F11A39-9756-489C-A559-E50D46822CC4}
Kayflow Server
SELECTED
{0B0EBD91-678F-45E5-A8CD-29240382D4F8}
Kayflow Server
INSTALLSERVER
{8D904CC3-E8A3-4910-82D1-512C008DF28E}
Kayflow Server
INSTALLSERVER
{65EA7076-E5D2-4AFF-BFAE-C3C252A2C90B}
progress
SUCCESS
FALSE
TRUE
{7A772195-8F75-4D37-983F-6F8465DF6D64}
progress
SUCCESS
FALSE
FALSE
{3306DD02-FB68-41B0-B4FD-18D1C5C625BA}
progress
SUCCESS
TRUE
FALSE
{F0EFDCDD-B744-4C8D-BE3A-739B86A98503}
PROGRAMFILES
20
FALSE
{DBD1453B-0D03-4D2D-80BD-447CF649D4DB}
COMMONFILES
20
TRUE
{0BF82EE1-11C5-4BE4-B434-7CD594FBBD3E}
SHORTCUTFILESALL
14
TRUE
{5D4AFC8F-942F-469A-BFEE-8CA1993EAC4D}
SHORTCUTFILES
14
FALSE
{C00C71C6-B039-4789-8BEA-6B2058819A58}
DESKTOPDIR
17
FALSE
{5EA8C7D9-A76E-4915-B795-99BFF4467A6A}
WINDIR
25
FALSE
{DD868BCC-7077-4D82-B8C5-4B3C484242CC}
WINSYSDIR
23
FALSE
{0600792A-6B5C-4EAE-B1C9-AA13790F33A1}
QUICKLAUNCHDIR
26
FALSE
{893B9AE2-F992-482F-B0F9-88CCBA97E290}
WWWROOTDIR
27
FALSE
{E310B51D-5167-48AB-BD90-E20C159979EA}
ISNT
18
{2CD8B713-0D9B-4D3E-854E-91D78DBF6F53}
CHECKSYSTEM
25
{A4A9D66D-7BD5-41BA-8B2A-2AA1C4C62371}
CHECKSYSTEM
0
{C327EA80-B1B3-42DD-AD14-C3BC061F17EF}
IS64
65
{02EA5EB0-011E-41C9-90DA-1DB32BB41174}
CHECKSYSTEM
37
{778FC5E2-8E15-454B-8FFF-65F2107F85B5}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Charts.v13.1.Core.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{ED9EE93C-E491-4030-9A84-FFEFFBD02AE2}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Data.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{06B312E0-A751-4879-9479-69A0EDC0DD66}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Docs.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{BBAE92F0-0AB4-4A47-BE58-35DC215406E0}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Office.v13.1.Core.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{D3317497-1196-4C16-8F4F-3C7869EEF187}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.PivotGrid.v13.1.Core.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{C15EF379-B7B6-4CBA-8F69-1202EBCE14CF}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Printing.v13.1.Core.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{8734F36F-3F6B-4B72-9563-5F1488B0B00D}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.RichEdit.v13.1.Core.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{DE042479-67D5-4C6F-A106-255606A54C3C}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Sparkline.v13.1.Core.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{AAB6CED0-4678-4253-A062-131D5CD9EE85}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Utils.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{EFF2E1BD-16B3-4FCC-A04C-AE9039E1A244}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.Utils.v13.1.UI.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{BB457A6B-7311-4D74-A430-ED14A0822C99}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraBars.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{934826ED-00BA-4611-A65F-171E5EAEFECA}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraCharts.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{2D201526-F91E-40B5-A7D6-7C816D65D93E}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraCharts.v13.1.Wizard.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{AF9B840C-4EFD-4F4E-8604-D268D9D1B439}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraEditors.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{DF77485F-1782-4018-A1FE-EAFD73A0FD1C}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraGrid.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{73CAB6C4-102B-49B6-9F20-51B339271D51}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraLayout.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{2663798C-D08A-4D2E-8BA4-3F7A30CE8CEF}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraPivotGrid.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{83539FBE-50C7-40EB-949D-83F47167F9E9}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraPrinting.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{1BCE1C29-5763-4A41-A341-C241D462FAE7}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraReports.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{A9A9787C-A510-45BB-9758-146ABAC81937}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraReports.v13.1.Extensions.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{F30096B7-867C-46F1-8BEF-8063B6B9AAD9}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\DevExpress.XtraTreeList.v13.1.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{33C956F1-61D4-45F0-8B89-DBF853B0D9DA}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Framework.SqlDataAccess.Controller.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{B61BEC7D-A9F7-42AC-AA43-512CE03768B8}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Framework.SqlDataAccess.Manager.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{388C18B1-4474-4E81-814E-9DDE99E0FA81}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Framework.SqlDataAccess.Model.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{860C21D0-FDD3-4D47-A3EE-2337F2FE9F01}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Kayflow.Controller.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{D399CD08-97DD-4755-B43C-E6C7AA7AE896}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Kayflow.Manager.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{220F8AC8-2650-4337-B6B1-4B3E295AB291}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Kayflow.Model.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{5560AA96-0C52-4590-8A3C-DA4F9BB427E6}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Kayflow.exe
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{EB9EE30D-1EE3-4E7C-A575-A12BAB17D070}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\Kayflow.exe.config
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{F32ABD6D-84CD-4113-99E1-14F77A64CC21}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\log4net.dll
FALSE|
$TARGETDIR$
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{20A82265-5F28-49EC-B779-DBB05D7C7459}
D:\Projects\Kailas\Kayflow\Source\Kayflow\bin\Release\ru\*.*
TRUE|
$TARGETDIR$\ru
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
FALSE
{15D2C589-D340-4D04-91BB-40E30862CECA}
$TARGETDIR$\Kayflow.exe
FALSE

FALSE

{0CD0DEDD-0A2D-4E75-9AFB-1BA139A7CB80}
$UNINSTALLLINK$
Uninstall #TITLE#
$SHORTCUTFOLDER$
Removes this InstallAware Software Corporation product




0
{D1427698-43EC-4DEE-9991-2CB03E0041C6}
$TARGETDIR$\Kayflow.exe
Kayflow
$SHORTCUTFOLDER$





0|
{0B2E13C2-0650-4A6A-864F-B7947474F7D1}
$TARGETDIR$\Kayflow.exe
Kayflow
$DESKTOPDIR$





0|
{1F768BF6-D273-4B4D-A3C2-B801C83B561A}
REMOVE=ALL,TRUE,$PRODUCTCODE$,FALSE,,,REMOVEOLD,ERROROLD,TRUE
mMSI.dll\mMSIExec.dll
{32E83325-BA5A-4B03-AF1A-CC9DE703BA9A}
.,SQLKFL,Kayflow,sa,qwe@poi1,SUCCESS,"if not exists(select * from sys.columns $NEWLINE$            where Name = N'OfficeID' and Object_ID = Object_ID(N'Act')) $NEWLINE$	ALTER TABLE [dbo].[Act]$NEWLINE$	ADD [OfficeID] uniqueidentifier NULL$NEWLINE$GO$NEWLINE$$NEWLINE$IF not EXISTS (SELECT * FROM sys.objects WHERE type = 'F' AND name = 'FK_Act_OfficeID_Office_OfficeID')$NEWLINE$BEGIN$NEWLINE$	ALTER TABLE [dbo].[Act]$NEWLINE$	ADD CONSTRAINT [FK_Act_OfficeID_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$	REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$	ON UPDATE NO ACTION$NEWLINE$	ON DELETE NO ACTION$NEWLINE$END$NEWLINE$GO$NEWLINE$$NEWLINE$update a$NEWLINE$set$NEWLINE$	a.OfficeID = e.OfficeID$NEWLINE$from Act a$NEWLINE$join Employee e on e.EmployeeID=a.EmployeeID$NEWLINE$where$NEWLINE$	a.OfficeID is null$NEWLINE$GO$NEWLINE$		$NEWLINE$ALTER TABLE [dbo].[Act]$NEWLINE$ALTER COLUMN [OfficeID] uniqueidentifier NOT NULL$NEWLINE$GO$NEWLINE$$NEWLINE$$NEWLINE$if not exists(select * from sys.columns $NEWLINE$            where Name = N'IsClosed' and Object_ID = Object_ID(N'Act')) $NEWLINE$begin$NEWLINE$	ALTER TABLE [dbo].[Act]$NEWLINE$	ADD [IsClosed] bit NULL$NEWLINE$END$NEWLINE$GO$NEWLINE$$NEWLINE$update act $NEWLINE$set$NEWLINE$	IsClosed = 0$NEWLINE$where$NEWLINE$	IsClosed is null$NEWLINE$GO$NEWLINE$$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Act]$NEWLINE$ALTER COLUMN [IsClosed] bit NOT NULL$NEWLINE$GO$NEWLINE$$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER VIEW dbo.vExpiredSteps$NEWLINE$AS$NEWLINE$with steps as$NEWLINE$($NEWLINE$select a.ActID$NEWLINE$    , case $NEWLINE$        when a.RelativeAlertDays is null then a.AlertDays$NEWLINE$        when a.RelativeAlertDays>a.AlertDays then a.RelativeAlertDays$NEWLINE$      else a.AlertDays$NEWLINE$      end DaysForAlert$NEWLINE$    , a.ActionName, a.OrdNum, a.ActActionID, a.AlertColor$NEWLINE$    , RANK() over (partition by a.ActID order by case $NEWLINE$        when a.RelativeAlertDays is null then a.AlertDays$NEWLINE$        when a.RelativeAlertDays>a.AlertDays then a.RelativeAlertDays$NEWLINE$      else a.AlertDays$NEWLINE$      end desc, a.OrdNum) RankID $NEWLINE$from$NEWLINE$    ($NEWLINE$      select s.ActID, aa.ActionName, aa.OrdNum, aa.ActActionID, aa.AlertColor$NEWLINE$          , DATEDIFF(dd, a.MeteringDate, getdate()) as DaysLeft$NEWLINE$          , case $NEWLINE$              when aa.AlertDays is not null then DATEDIFF(dd, a.MeteringDate, getdate()) - aa.AlertDays$NEWLINE$            else$NEWLINE$              NULL$NEWLINE$            end AlertDays   $NEWLINE$          , null RelativeAlertDays$NEWLINE$      from Step s$NEWLINE$      join ActAction aa on aa.ActActionID=s.ActActionID$NEWLINE$      join Act a on a.ActID=s.ActID$NEWLINE$      where$NEWLINE$          s.Received is null$NEWLINE$          and isnull(aa.RelativeAlertDays, 0) = 0$NEWLINE$      union all$NEWLINE$      select tmp.ActID, tmp.ActionName, tmp.OrdNum, tmp.ActActionID, tmp.AlertColor, tmp.DaysLeft, tmp.AlertDays$NEWLINE$          , case$NEWLINE$              when tmp.DaysDiff is null then null$NEWLINE$              else DATEDIFF(dd, tmp.DaysDiff, getdate()) - tmp.RelativeAlertDays$NEWLINE$            end RelativeAlertDays$NEWLINE$      from ($NEWLINE$            select s.ActID, aa.ActionName, aa.OrdNum, aa.ActActionID, aa.AlertColor$NEWLINE$                  , DATEDIFF(dd, a.MeteringDate, getdate()) as DaysLeft$NEWLINE$                  , case $NEWLINE$                      when aa.AlertDays is not null then DATEDIFF(dd, a.MeteringDate, getdate()) - aa.AlertDays$NEWLINE$                    else$NEWLINE$                      NULL$NEWLINE$                    end AlertDays  $NEWLINE$                  , (select top 1 st.Received$NEWLINE$                      from Step st$NEWLINE$                      join ActAction aat on aat.ActActionID=st.ActActionID$NEWLINE$                      where$NEWLINE$                        ActID = s.ActID$NEWLINE$                        and aat.OrdNum<aa.OrdNum$NEWLINE$                      order by$NEWLINE$                        aat.OrdNum desc) DaysDiff$NEWLINE$                  , aa.RelativeAlertDays      $NEWLINE$              from Step s$NEWLINE$              join ActAction aa on aa.ActActionID=s.ActActionID$NEWLINE$              join Act a on a.ActID=s.ActID$NEWLINE$              where$NEWLINE$                  s.Received is null$NEWLINE$                  and isnull(aa.RelativeAlertDays, 0) != 0  $NEWLINE$           ) as tmp$NEWLINE$    ) as a$NEWLINE$)$NEWLINE$select s.ActID, s.ActionName, s.OrdNum, s.ActActionID, s.AlertColor, s.DaysForAlert$NEWLINE$from steps s$NEWLINE$where$NEWLINE$    s.RankID = 1$NEWLINE$    and s.DaysForAlert>0$NEWLINE$GO$NEWLINE$$NEWLINE$IF EXISTS (SELECT * FROM sys.objects WHERE type = 'TF' AND name = 'f_Acts')$NEWLINE$BEGIN$NEWLINE$	DROP FUNCtion [dbo].f_Acts$NEWLINE$END$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE FUNCTION dbo.f_Acts ()$NEWLINE$RETURNS @Result TABLE($NEWLINE$    ActID UNIQUEIDENTIFIER,$NEWLINE$    EmployeeID UNIQUEIDENTIFIER,$NEWLINE$    MeteringDate DATETIME,$NEWLINE$    TerritorialUnitID UNIQUEIDENTIFIER,$NEWLINE$    [Address] NVARCHAR(256),$NEWLINE$    CustomerName NVARCHAR(256),$NEWLINE$    CustomerPhone NVARCHAR(36),$NEWLINE$    AreaAmount INT,$NEWLINE$    ActAmount INT,$NEWLINE$    CategoryID UNIQUEIDENTIFIER,$NEWLINE$    TotalCost FLOAT,$NEWLINE$    PaidOn FLOAT,$NEWLINE$    LeftOn FLOAT,$NEWLINE$    Approval1 FLOAT,$NEWLINE$    KailasPaid1 FLOAT,$NEWLINE$    KailasDue FLOAT,$NEWLINE$    PaidDue FLOAT,$NEWLINE$    Approval2 FLOAT,$NEWLINE$    KailasPaid2 FLOAT,$NEWLINE$    SalaryCalculated FLOAT,$NEWLINE$    SalaryPaidDate DATETIME,$NEWLINE$    CalculatedMain FLOAT,$NEWLINE$    PaidMainDate DATETIME,$NEWLINE$    ActDate DATETIME,$NEWLINE$    ActNum VARCHAR(10),$NEWLINE$    [Description] NVARCHAR(256),$NEWLINE$	[OfficeID] uniqueidentifier,$NEWLINE$	[IsClosed] bit,$NEWLINE$    EmployeeName NVARCHAR(386),$NEWLINE$    [UnitName] nvarchar(128),$NEWLINE$    [CategoryName] nvarchar(128),$NEWLINE$    [StateID] uniqueidentifier,$NEWLINE$    [StateName] nvarchar(128),$NEWLINE$    AlertStep varchar(128),$NEWLINE$    AlertDays int,$NEWLINE$    AlertColor int$NEWLINE$    )$NEWLINE$AS$NEWLINE$begin$NEWLINE$    declare @ExpireSteps TABLE($NEWLINE$        ActID uniqueidentifier,$NEWLINE$        ActionName varchar(128),$NEWLINE$        DaysForAlert int,$NEWLINE$        AlertColor int$NEWLINE$    )$NEWLINE$$NEWLINE$    insert into @ExpireSteps$NEWLINE$    select ActID, ActionName, DaysForAlert, AlertColor from vExpiredSteps e$NEWLINE$$NEWLINE$    insert into @Result$NEWLINE$    select a.ActID, a.EmployeeID, a.MeteringDate, a.TerritorialUnitID, a.[Address], a.CustomerName$NEWLINE$        , a.CustomerPhone, a.AreaAmount, a.ActAmount, a.CategoryID, a.TotalCost, a.PaidOn, a.LeftOn$NEWLINE$        , a.Approval1, a.KailasPaid1, a.KailasDue, a.PaidDue, a.Approval2, a.KailasPaid2, a.SalaryCalculated$NEWLINE$        , a.SalaryPaidDate, a.CalculatedMain, a.PaidMainDate, a.ActDate, a.ActNum, a.[Description]$NEWLINE$		, a.OfficeID, a.IsClosed$NEWLINE$        , e.DisplayName EmployeeName$NEWLINE$        , t.UnitName$NEWLINE$        , c.CategoryName$NEWLINE$        , s.StateID, s.StateName$NEWLINE$        , es.ActionName, es.DaysForAlert, es.AlertColor$NEWLINE$    from Act a$NEWLINE$    join vEmployee e on e.EmployeeID=a.EmployeeID$NEWLINE$    join TerritorialUnit t on t.TerritorialUnitID=a.TerritorialUnitID$NEWLINE$    join Category c on c.CategoryID=a.CategoryID$NEWLINE$    left join @ExpireSteps es on es.ActID=a.ActID$NEWLINE$    left join$NEWLINE$        ($NEWLINE$            select s.StateID, s.StateName, h.ActID$NEWLINE$            from StateHistory h$NEWLINE$            join [State] s on s.StateID=h.StateID$NEWLINE$            where$NEWLINE$                h.StateHistoryID = $NEWLINE$                  (select top 1 StateHistoryID$NEWLINE$                   from StateHistory$NEWLINE$                   where ActID=h.ActID$NEWLINE$                   order by OnDate desc)$NEWLINE$        ) s on s.ActID = a.ActID$NEWLINE$$NEWLINE$    return    $NEWLINE$end      $NEWLINE$GO    $NEWLINE$",0,0
mMSSQLIDE.dll\mMSSQLExec.dll
{094F314E-0D87-4857-A917-980282D0C449}
.,SQLKFL,Kayflow,sa,qwe@poi1,SUCCESS,"--if db_id('Kayflow') is not null$NEWLINE$--	RAISERROR ('DB Already Exists', 20, 1) WITH LOG$NEWLINE$--GO$NEWLINE$$NEWLINE$--CREATE DATABASE [Kayflow]$NEWLINE$--COLLATE Ukrainian_CI_AS$NEWLINE$--GO$NEWLINE$$NEWLINE$--USE [Kayflow]$NEWLINE$--GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Category : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Category] ($NEWLINE$  [CategoryID] uniqueidentifier CONSTRAINT [DF_Category_CategoryID] DEFAULT newid() NOT NULL,$NEWLINE$  [CategoryName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Office : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Office] ($NEWLINE$  [OfficeID] uniqueidentifier CONSTRAINT [DF_Office_OfficeID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [IsDefault] bit NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table TerritorialUnit : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[TerritorialUnit] ($NEWLINE$  [TerritorialUnitID] uniqueidentifier CONSTRAINT [DF_TerritorialUnit_TerritorialUnitID] DEFAULT newid() NOT NULL,$NEWLINE$  [ParentID] uniqueidentifier NULL,$NEWLINE$  [UnitName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [UnitType] int NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Employee : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Employee] ($NEWLINE$  [EmployeeID] uniqueidentifier CONSTRAINT [DF_Employee_EmployeeID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [FirstName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [LastName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [MiddleName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [Login] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [Password] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [Permission] int NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Act : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Act] ($NEWLINE$  [ActID] uniqueidentifier CONSTRAINT [DF_Act_ActID] DEFAULT newid() NOT NULL,$NEWLINE$  [EmployeeID] uniqueidentifier NOT NULL,$NEWLINE$  [MeteringDate] datetime NOT NULL,$NEWLINE$  [TerritorialUnitID] uniqueidentifier NOT NULL,$NEWLINE$  [Address] nvarchar(256) COLLATE Ukrainian_CI_AS NULL,$NEWLINE$  [CustomerName] nvarchar(256) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [CustomerPhone] nvarchar(36) COLLATE Ukrainian_CI_AS NULL,$NEWLINE$  [AreaAmount] int NOT NULL,$NEWLINE$  [ActAmount] int NOT NULL,$NEWLINE$  [CategoryID] uniqueidentifier NOT NULL,$NEWLINE$  [TotalCost] float NULL,$NEWLINE$  [PaidOn] float NULL,$NEWLINE$  [LeftOn] float NULL,$NEWLINE$  [Approval1] float NULL,$NEWLINE$  [KailasPaid1] float NULL,$NEWLINE$  [KailasDue] float NULL,$NEWLINE$  [PaidDue] float NULL,$NEWLINE$  [Approval2] float NULL,$NEWLINE$  [KailasPaid2] float NULL,$NEWLINE$  [SalaryCalculated] float NOT NULL,$NEWLINE$  [SalaryPaidDate] datetime NULL,$NEWLINE$  [CalculatedMain] float NOT NULL,$NEWLINE$  [PaidMainDate] datetime NULL,$NEWLINE$  [ActDate] datetime NULL,$NEWLINE$  [ActNum] varchar(10) COLLATE Ukrainian_CI_AS NULL,$NEWLINE$  [Description] nvarchar(256) COLLATE Ukrainian_CI_AS NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table ActAction : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[ActAction] ($NEWLINE$  [ActActionID] uniqueidentifier CONSTRAINT [DF_ActAction_ActActionID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [ActionName] varchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [OrdNum] int NOT NULL,$NEWLINE$  [Hidden] bit NOT NULL,$NEWLINE$  [AlertDays] int NULL,$NEWLINE$  [RelativeAlertDays] int NULL,$NEWLINE$  [AlertColor] int NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table ValueSet : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[ValueSet] ($NEWLINE$  [ValueSetID] uniqueidentifier CONSTRAINT [DF_ValueSet_ValueSetID] DEFAULT newid() NOT NULL,$NEWLINE$  [SetName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table DocumentValue : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[DocumentValue] ($NEWLINE$  [DocumentValueID] uniqueidentifier CONSTRAINT [DF_DocumentValue_DocumentValueID] DEFAULT newid() NOT NULL,$NEWLINE$  [ValueSetID] uniqueidentifier NOT NULL,$NEWLINE$  [DocValue] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [DocColor] int NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table DocumentGroup : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[DocumentGroup] ($NEWLINE$  [DocumentGroupID] uniqueidentifier CONSTRAINT [DF_DocumentGroup_DocumentGroupID] DEFAULT newid() NOT NULL,$NEWLINE$  [GroupName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [OrdNum] int NOT NULL,$NEWLINE$  [Hidden] bit NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Document : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Document] ($NEWLINE$  [DocumentID] uniqueidentifier CONSTRAINT [DF_Document_DocumentID] DEFAULT newid() NOT NULL,$NEWLINE$  [DocumentName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [DocumentGroupID] uniqueidentifier NOT NULL,$NEWLINE$  [OrdNum] int NOT NULL,$NEWLINE$  [Hidden] bit NOT NULL,$NEWLINE$  [ValueSetID] uniqueidentifier NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table ActDocument : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[ActDocument] ($NEWLINE$  [ActDocumentID] uniqueidentifier CONSTRAINT [DF_ActDocument_ActDocumentID] DEFAULT newid() NOT NULL,$NEWLINE$  [ActID] uniqueidentifier NOT NULL,$NEWLINE$  [DocumentID] uniqueidentifier NOT NULL,$NEWLINE$  [DocumentValueID] uniqueidentifier NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table ActHistory : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[ActHistory] ($NEWLINE$  [ActHistoryID] uniqueidentifier CONSTRAINT [DF_ActHistory_ActHistoryID] DEFAULT newid() NOT NULL,$NEWLINE$  [EmployeeID] uniqueidentifier NOT NULL,$NEWLINE$  [OnDate] datetime NOT NULL,$NEWLINE$  [Description] nvarchar(1024) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [ActID] uniqueidentifier NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Cost : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Cost] ($NEWLINE$  [CostID] uniqueidentifier CONSTRAINT [DF_Cost_CostID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [CostName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [Hidden] bit NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Expense : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Expense] ($NEWLINE$  [ExpenseID] uniqueidentifier CONSTRAINT [DF_Expense_ExpenseID] DEFAULT newid() NOT NULL,$NEWLINE$  [EmployeeID] uniqueidentifier NOT NULL,$NEWLINE$  [OnDate] datetime NOT NULL,$NEWLINE$  [Distance] int NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table ExpenseCost : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[ExpenseCost] ($NEWLINE$  [ExpenseID] uniqueidentifier NOT NULL,$NEWLINE$  [CostID] uniqueidentifier NOT NULL,$NEWLINE$  [Amount] float NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Layout : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Layout] ($NEWLINE$  [LayoutID] uniqueidentifier CONSTRAINT [DF_Layout_LayoutID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [LayoutData] varbinary(max) NOT NULL,$NEWLINE$  [LayoutType] int NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Note : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Note] ($NEWLINE$  [NoteID] uniqueidentifier CONSTRAINT [DF_Note_NoteID] DEFAULT newid() NOT NULL,$NEWLINE$  [ActID] uniqueidentifier NOT NULL,$NEWLINE$  [EmployeeID] uniqueidentifier NOT NULL,$NEWLINE$  [OnDate] datetime NOT NULL,$NEWLINE$  [Description] nvarchar(512) COLLATE Ukrainian_CI_AS NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table PaymentDataSettings : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[PaymentDataSettings] ($NEWLINE$  [PaymentDataSettingsID] uniqueidentifier CONSTRAINT [DF_PaymentDataSettings_PaymentDataSettingsID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [PaymentFieldID] int NOT NULL,$NEWLINE$  [Show] bit NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table State : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[State] ($NEWLINE$  [StateID] uniqueidentifier CONSTRAINT [DF_State_StateID] DEFAULT newid() NOT NULL,$NEWLINE$  [OfficeID] uniqueidentifier NOT NULL,$NEWLINE$  [StateName] nvarchar(128) COLLATE Ukrainian_CI_AS NOT NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table StateHistory : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[StateHistory] ($NEWLINE$  [StateHistoryID] uniqueidentifier CONSTRAINT [DF_StateHistory_StateHistoryID] DEFAULT newid() NOT NULL,$NEWLINE$  [ActID] uniqueidentifier NOT NULL,$NEWLINE$  [StateID] uniqueidentifier NOT NULL,$NEWLINE$  [EmployeeID] uniqueidentifier NOT NULL,$NEWLINE$  [OnDate] datetime NOT NULL,$NEWLINE$  [Description] nvarchar(1024) COLLATE Ukrainian_CI_AS NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table Step : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[Step] ($NEWLINE$  [StepID] uniqueidentifier CONSTRAINT [DF_Step_StepID] DEFAULT newid() NOT NULL,$NEWLINE$  [ActID] uniqueidentifier NOT NULL,$NEWLINE$  [ActActionID] uniqueidentifier NOT NULL,$NEWLINE$  [EmployeeID] uniqueidentifier NOT NULL,$NEWLINE$  [Delivered] datetime NULL,$NEWLINE$  [Received] datetime NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for table sysdiagrams : $NEWLINE$--$NEWLINE$$NEWLINE$CREATE TABLE [dbo].[sysdiagrams] ($NEWLINE$  [name] sysname COLLATE Ukrainian_CI_AS NOT NULL,$NEWLINE$  [principal_id] int NOT NULL,$NEWLINE$  [diagram_id] int IDENTITY(1, 1) NOT NULL,$NEWLINE$  [version] int NULL,$NEWLINE$  [definition] varbinary(max) NULL$NEWLINE$)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for user-defined function fn_diagramobjects : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE FUNCTION dbo.fn_diagramobjects() $NEWLINE$	RETURNS int$NEWLINE$	WITH EXECUTE AS N'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		declare @id_upgraddiagrams		int$NEWLINE$		declare @id_sysdiagrams			int$NEWLINE$		declare @id_helpdiagrams		int$NEWLINE$		declare @id_helpdiagramdefinition	int$NEWLINE$		declare @id_creatediagram	int$NEWLINE$		declare @id_renamediagram	int$NEWLINE$		declare @id_alterdiagram 	int $NEWLINE$		declare @id_dropdiagram		int$NEWLINE$		declare @InstalledObjects	int$NEWLINE$$NEWLINE$		select @InstalledObjects = 0$NEWLINE$$NEWLINE$		select 	@id_upgraddiagrams = object_id(N'dbo.sp_upgraddiagrams'),$NEWLINE$			@id_sysdiagrams = object_id(N'dbo.sysdiagrams'),$NEWLINE$			@id_helpdiagrams = object_id(N'dbo.sp_helpdiagrams'),$NEWLINE$			@id_helpdiagramdefinition = object_id(N'dbo.sp_helpdiagramdefinition'),$NEWLINE$			@id_creatediagram = object_id(N'dbo.sp_creatediagram'),$NEWLINE$			@id_renamediagram = object_id(N'dbo.sp_renamediagram'),$NEWLINE$			@id_alterdiagram = object_id(N'dbo.sp_alterdiagram'), $NEWLINE$			@id_dropdiagram = object_id(N'dbo.sp_dropdiagram')$NEWLINE$$NEWLINE$		if @id_upgraddiagrams is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 1$NEWLINE$		if @id_sysdiagrams is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 2$NEWLINE$		if @id_helpdiagrams is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 4$NEWLINE$		if @id_helpdiagramdefinition is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 8$NEWLINE$		if @id_creatediagram is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 16$NEWLINE$		if @id_renamediagram is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 32$NEWLINE$		if @id_alterdiagram  is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 64$NEWLINE$		if @id_dropdiagram is not null$NEWLINE$			select @InstalledObjects = @InstalledObjects + 128$NEWLINE$		$NEWLINE$		return @InstalledObjects $NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for view vEmployee : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE VIEW dbo.vEmployee$NEWLINE$AS$NEWLINE$  select e.*, o.OfficeName$NEWLINE$  	, e.LastName + ' ' + e.FirstName + ' ' + e.MiddleName DisplayName$NEWLINE$  from Employee e$NEWLINE$  join Office o on o.OfficeID=e.OfficeID$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for view vExpenseCost : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE VIEW dbo.vExpenseCost$NEWLINE$AS$NEWLINE$	select e.*$NEWLINE$    	, c.CostName$NEWLINE$    from ExpenseCost e$NEWLINE$    join Cost c on c.CostID=e.CostID$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for view vExpiredSteps : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE VIEW dbo.vExpiredSteps$NEWLINE$AS$NEWLINE$with steps as$NEWLINE$($NEWLINE$select a.ActID$NEWLINE$	, case $NEWLINE$    	when a.RelativeAlertDays is null then a.AlertDays$NEWLINE$        when a.RelativeAlertDays>a.AlertDays then a.RelativeAlertDays$NEWLINE$      else a.AlertDays$NEWLINE$      end DaysForAlert$NEWLINE$    , a.ActionName, a.OrdNum, a.ActActionID, a.AlertColor$NEWLINE$    , RANK() over (partition by a.ActID order by case $NEWLINE$    	when a.RelativeAlertDays is null then a.AlertDays$NEWLINE$        when a.RelativeAlertDays>a.AlertDays then a.RelativeAlertDays$NEWLINE$      else a.AlertDays$NEWLINE$      end desc, a.OrdNum) RankID $NEWLINE$from$NEWLINE$	($NEWLINE$      select s.ActID, aa.ActionName, aa.OrdNum, aa.ActActionID, aa.AlertColor$NEWLINE$          , DATEDIFF(dd, a.MeteringDate, getdate()) as DaysLeft$NEWLINE$          , case $NEWLINE$              when aa.AlertDays is not null then DATEDIFF(dd, a.MeteringDate, getdate()) - aa.AlertDays$NEWLINE$            else$NEWLINE$              NULL$NEWLINE$            end AlertDays   $NEWLINE$          , case$NEWLINE$              when isnull(aa.RelativeAlertDays, 0) = 0 then null$NEWLINE$              when isnull(aa.RelativeAlertDays, 0) != 0 then $NEWLINE$                  case $NEWLINE$                      when (select top 1 st.Received$NEWLINE$                                        from Step st$NEWLINE$                                        join ActAction aat on aat.ActActionID=st.ActActionID$NEWLINE$                                        where$NEWLINE$                                          ActID = s.ActID$NEWLINE$                                          and aat.OrdNum<aa.OrdNum$NEWLINE$                                        order by$NEWLINE$                                          aat.OrdNum desc) is null then null$NEWLINE$                      else DATEDIFF(dd, (select top 1 st.Received$NEWLINE$                                        from Step st$NEWLINE$                                        join ActAction aat on aat.ActActionID=st.ActActionID$NEWLINE$                                        where$NEWLINE$                                          ActID = s.ActID$NEWLINE$                                          and aat.OrdNum<aa.OrdNum$NEWLINE$                                        order by$NEWLINE$                                          aat.OrdNum desc), getdate()) - aa.RelativeAlertDays$NEWLINE$                   end   	                    $NEWLINE$            end RelativeAlertDays$NEWLINE$      from Step s$NEWLINE$      join ActAction aa on aa.ActActionID=s.ActActionID$NEWLINE$      join Act a on a.ActID=s.ActID$NEWLINE$      where$NEWLINE$          s.Received is null$NEWLINE$	) as a$NEWLINE$)$NEWLINE$select s.ActID, s.ActionName, s.OrdNum, s.ActActionID, s.AlertColor, s.DaysForAlert$NEWLINE$from steps s$NEWLINE$where$NEWLINE$	s.RankID = 1$NEWLINE$    and s.DaysForAlert>0$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_alterdiagram : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_alterdiagram$NEWLINE$	($NEWLINE$		@diagramname 	sysname,$NEWLINE$		@owner_id	int	= null,$NEWLINE$		@version 	int,$NEWLINE$		@definition 	varbinary(max)$NEWLINE$	)$NEWLINE$	WITH EXECUTE AS 'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		set nocount on$NEWLINE$	$NEWLINE$		declare @theId 			int$NEWLINE$		declare @retval 		int$NEWLINE$		declare @IsDbo 			int$NEWLINE$		$NEWLINE$		declare @UIDFound 		int$NEWLINE$		declare @DiagId			int$NEWLINE$		declare @ShouldChangeUID	int$NEWLINE$	$NEWLINE$		if(@diagramname is null)$NEWLINE$		begin$NEWLINE$			RAISERROR ('Invalid ARG', 16, 1)$NEWLINE$			return -1$NEWLINE$		end$NEWLINE$	$NEWLINE$		execute as caller;$NEWLINE$		select @theId = DATABASE_PRINCIPAL_ID();	 $NEWLINE$		select @IsDbo = IS_MEMBER(N'db_owner'); $NEWLINE$		if(@owner_id is null)$NEWLINE$			select @owner_id = @theId;$NEWLINE$		revert;$NEWLINE$	$NEWLINE$		select @ShouldChangeUID = 0$NEWLINE$		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname $NEWLINE$		$NEWLINE$		if(@DiagId IS NULL or (@IsDbo = 0 and @theId <> @UIDFound))$NEWLINE$		begin$NEWLINE$			RAISERROR ('Diagram does not exist or you do not have permission.', 16, 1);$NEWLINE$			return -3$NEWLINE$		end$NEWLINE$	$NEWLINE$		if(@IsDbo <> 0)$NEWLINE$		begin$NEWLINE$			if(@UIDFound is null or USER_NAME(@UIDFound) is null) -- invalid principal_id$NEWLINE$			begin$NEWLINE$				select @ShouldChangeUID = 1 ;$NEWLINE$			end$NEWLINE$		end$NEWLINE$$NEWLINE$		-- update dds data			$NEWLINE$		update dbo.sysdiagrams set definition = @definition where diagram_id = @DiagId ;$NEWLINE$$NEWLINE$		-- change owner$NEWLINE$		if(@ShouldChangeUID = 1)$NEWLINE$			update dbo.sysdiagrams set principal_id = @theId where diagram_id = @DiagId ;$NEWLINE$$NEWLINE$		-- update dds version$NEWLINE$		if(@version is not null)$NEWLINE$			update dbo.sysdiagrams set version = @version where diagram_id = @DiagId ;$NEWLINE$$NEWLINE$		return 0$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_creatediagram : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_creatediagram$NEWLINE$	($NEWLINE$		@diagramname 	sysname,$NEWLINE$		@owner_id		int	= null, 	$NEWLINE$		@version 		int,$NEWLINE$		@definition 	varbinary(max)$NEWLINE$	)$NEWLINE$	WITH EXECUTE AS 'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		set nocount on$NEWLINE$	$NEWLINE$		declare @theId int$NEWLINE$		declare @retval int$NEWLINE$		declare @IsDbo	int$NEWLINE$		declare @userName sysname$NEWLINE$		if(@version is null or @diagramname is null)$NEWLINE$		begin$NEWLINE$			RAISERROR (N'E_INVALIDARG', 16, 1);$NEWLINE$			return -1$NEWLINE$		end$NEWLINE$	$NEWLINE$		execute as caller;$NEWLINE$		select @theId = DATABASE_PRINCIPAL_ID(); $NEWLINE$		select @IsDbo = IS_MEMBER(N'db_owner');$NEWLINE$		revert; $NEWLINE$		$NEWLINE$		if @owner_id is null$NEWLINE$		begin$NEWLINE$			select @owner_id = @theId;$NEWLINE$		end$NEWLINE$		else$NEWLINE$		begin$NEWLINE$			if @theId <> @owner_id$NEWLINE$			begin$NEWLINE$				if @IsDbo = 0$NEWLINE$				begin$NEWLINE$					RAISERROR (N'E_INVALIDARG', 16, 1);$NEWLINE$					return -1$NEWLINE$				end$NEWLINE$				select @theId = @owner_id$NEWLINE$			end$NEWLINE$		end$NEWLINE$		-- next 2 line only for test, will be removed after define name unique$NEWLINE$		if EXISTS(select diagram_id from dbo.sysdiagrams where principal_id = @theId and name = @diagramname)$NEWLINE$		begin$NEWLINE$			RAISERROR ('The name is already used.', 16, 1);$NEWLINE$			return -2$NEWLINE$		end$NEWLINE$	$NEWLINE$		insert into dbo.sysdiagrams(name, principal_id , version, definition)$NEWLINE$				VALUES(@diagramname, @theId, @version, @definition) ;$NEWLINE$		$NEWLINE$		select @retval = @@IDENTITY $NEWLINE$		return @retval$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_dropdiagram : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_dropdiagram$NEWLINE$	($NEWLINE$		@diagramname 	sysname,$NEWLINE$		@owner_id	int	= null$NEWLINE$	)$NEWLINE$	WITH EXECUTE AS 'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		set nocount on$NEWLINE$		declare @theId 			int$NEWLINE$		declare @IsDbo 			int$NEWLINE$		$NEWLINE$		declare @UIDFound 		int$NEWLINE$		declare @DiagId			int$NEWLINE$	$NEWLINE$		if(@diagramname is null)$NEWLINE$		begin$NEWLINE$			RAISERROR ('Invalid value', 16, 1);$NEWLINE$			return -1$NEWLINE$		end$NEWLINE$	$NEWLINE$		EXECUTE AS CALLER;$NEWLINE$		select @theId = DATABASE_PRINCIPAL_ID();$NEWLINE$		select @IsDbo = IS_MEMBER(N'db_owner'); $NEWLINE$		if(@owner_id is null)$NEWLINE$			select @owner_id = @theId;$NEWLINE$		REVERT; $NEWLINE$		$NEWLINE$		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname $NEWLINE$		if(@DiagId IS NULL or (@IsDbo = 0 and @UIDFound <> @theId))$NEWLINE$		begin$NEWLINE$			RAISERROR ('Diagram does not exist or you do not have permission.', 16, 1)$NEWLINE$			return -3$NEWLINE$		end$NEWLINE$	$NEWLINE$		delete from dbo.sysdiagrams where diagram_id = @DiagId;$NEWLINE$	$NEWLINE$		return 0;$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_helpdiagramdefinition : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_helpdiagramdefinition$NEWLINE$	($NEWLINE$		@diagramname 	sysname,$NEWLINE$		@owner_id	int	= null 		$NEWLINE$	)$NEWLINE$	WITH EXECUTE AS N'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		set nocount on$NEWLINE$$NEWLINE$		declare @theId 		int$NEWLINE$		declare @IsDbo 		int$NEWLINE$		declare @DiagId		int$NEWLINE$		declare @UIDFound	int$NEWLINE$	$NEWLINE$		if(@diagramname is null)$NEWLINE$		begin$NEWLINE$			RAISERROR (N'E_INVALIDARG', 16, 1);$NEWLINE$			return -1$NEWLINE$		end$NEWLINE$	$NEWLINE$		execute as caller;$NEWLINE$		select @theId = DATABASE_PRINCIPAL_ID();$NEWLINE$		select @IsDbo = IS_MEMBER(N'db_owner');$NEWLINE$		if(@owner_id is null)$NEWLINE$			select @owner_id = @theId;$NEWLINE$		revert; $NEWLINE$	$NEWLINE$		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname;$NEWLINE$		if(@DiagId IS NULL or (@IsDbo = 0 and @UIDFound <> @theId ))$NEWLINE$		begin$NEWLINE$			RAISERROR ('Diagram does not exist or you do not have permission.', 16, 1);$NEWLINE$			return -3$NEWLINE$		end$NEWLINE$$NEWLINE$		select version, definition FROM dbo.sysdiagrams where diagram_id = @DiagId ; $NEWLINE$		return 0$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_helpdiagrams : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_helpdiagrams$NEWLINE$	($NEWLINE$		@diagramname sysname = NULL,$NEWLINE$		@owner_id int = NULL$NEWLINE$	)$NEWLINE$	WITH EXECUTE AS N'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		DECLARE @user sysname$NEWLINE$		DECLARE @dboLogin bit$NEWLINE$		EXECUTE AS CALLER;$NEWLINE$			SET @user = USER_NAME();$NEWLINE$			SET @dboLogin = CONVERT(bit,IS_MEMBER('db_owner'));$NEWLINE$		REVERT;$NEWLINE$		SELECT$NEWLINE$			[Database] = DB_NAME(),$NEWLINE$			[Name] = name,$NEWLINE$			[ID] = diagram_id,$NEWLINE$			[Owner] = USER_NAME(principal_id),$NEWLINE$			[OwnerID] = principal_id$NEWLINE$		FROM$NEWLINE$			sysdiagrams$NEWLINE$		WHERE$NEWLINE$			(@dboLogin = 1 OR USER_NAME(principal_id) = @user) AND$NEWLINE$			(@diagramname IS NULL OR name = @diagramname) AND$NEWLINE$			(@owner_id IS NULL OR principal_id = @owner_id)$NEWLINE$		ORDER BY$NEWLINE$			4, 5, 1$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_renamediagram : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_renamediagram$NEWLINE$	($NEWLINE$		@diagramname 		sysname,$NEWLINE$		@owner_id		int	= null,$NEWLINE$		@new_diagramname	sysname$NEWLINE$	$NEWLINE$	)$NEWLINE$	WITH EXECUTE AS 'dbo'$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		set nocount on$NEWLINE$		declare @theId 			int$NEWLINE$		declare @IsDbo 			int$NEWLINE$		$NEWLINE$		declare @UIDFound 		int$NEWLINE$		declare @DiagId			int$NEWLINE$		declare @DiagIdTarg		int$NEWLINE$		declare @u_name			sysname$NEWLINE$		if((@diagramname is null) or (@new_diagramname is null))$NEWLINE$		begin$NEWLINE$			RAISERROR ('Invalid value', 16, 1);$NEWLINE$			return -1$NEWLINE$		end$NEWLINE$	$NEWLINE$		EXECUTE AS CALLER;$NEWLINE$		select @theId = DATABASE_PRINCIPAL_ID();$NEWLINE$		select @IsDbo = IS_MEMBER(N'db_owner'); $NEWLINE$		if(@owner_id is null)$NEWLINE$			select @owner_id = @theId;$NEWLINE$		REVERT;$NEWLINE$	$NEWLINE$		select @u_name = USER_NAME(@owner_id)$NEWLINE$	$NEWLINE$		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname $NEWLINE$		if(@DiagId IS NULL or (@IsDbo = 0 and @UIDFound <> @theId))$NEWLINE$		begin$NEWLINE$			RAISERROR ('Diagram does not exist or you do not have permission.', 16, 1)$NEWLINE$			return -3$NEWLINE$		end$NEWLINE$	$NEWLINE$		-- if((@u_name is not null) and (@new_diagramname = @diagramname))	-- nothing will change$NEWLINE$		--	return 0;$NEWLINE$	$NEWLINE$		if(@u_name is null)$NEWLINE$			select @DiagIdTarg = diagram_id from dbo.sysdiagrams where principal_id = @theId and name = @new_diagramname$NEWLINE$		else$NEWLINE$			select @DiagIdTarg = diagram_id from dbo.sysdiagrams where principal_id = @owner_id and name = @new_diagramname$NEWLINE$	$NEWLINE$		if((@DiagIdTarg is not null) and  @DiagId <> @DiagIdTarg)$NEWLINE$		begin$NEWLINE$			RAISERROR ('The name is already used.', 16, 1);$NEWLINE$			return -2$NEWLINE$		end		$NEWLINE$	$NEWLINE$		if(@u_name is null)$NEWLINE$			update dbo.sysdiagrams set [name] = @new_diagramname, principal_id = @theId where diagram_id = @DiagId$NEWLINE$		else$NEWLINE$			update dbo.sysdiagrams set [name] = @new_diagramname where diagram_id = @DiagId$NEWLINE$		return 0$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure sp_upgraddiagrams : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$	CREATE PROCEDURE dbo.sp_upgraddiagrams$NEWLINE$	AS$NEWLINE$	BEGIN$NEWLINE$		IF OBJECT_ID(N'dbo.sysdiagrams') IS NOT NULL$NEWLINE$			return 0;$NEWLINE$	$NEWLINE$		CREATE TABLE dbo.sysdiagrams$NEWLINE$		($NEWLINE$			name sysname NOT NULL,$NEWLINE$			principal_id int NOT NULL,	-- we may change it to varbinary(85)$NEWLINE$			diagram_id int PRIMARY KEY IDENTITY,$NEWLINE$			version int,$NEWLINE$	$NEWLINE$			definition varbinary(max)$NEWLINE$			CONSTRAINT UK_principal_name UNIQUE$NEWLINE$			($NEWLINE$				principal_id,$NEWLINE$				name$NEWLINE$			)$NEWLINE$		);$NEWLINE$$NEWLINE$$NEWLINE$		/* Add this if we need to have some form of extended properties for diagrams */$NEWLINE$		/*$NEWLINE$		IF OBJECT_ID(N'dbo.sysdiagram_properties') IS NULL$NEWLINE$		BEGIN$NEWLINE$			CREATE TABLE dbo.sysdiagram_properties$NEWLINE$			($NEWLINE$				diagram_id int,$NEWLINE$				name sysname,$NEWLINE$				value varbinary(max) NOT NULL$NEWLINE$			)$NEWLINE$		END$NEWLINE$		*/$NEWLINE$$NEWLINE$		IF OBJECT_ID(N'dbo.dtproperties') IS NOT NULL$NEWLINE$		begin$NEWLINE$			insert into dbo.sysdiagrams$NEWLINE$			($NEWLINE$				[name],$NEWLINE$				[principal_id],$NEWLINE$				[version],$NEWLINE$				[definition]$NEWLINE$			)$NEWLINE$			select	 $NEWLINE$				convert(sysname, dgnm.[uvalue]),$NEWLINE$				DATABASE_PRINCIPAL_ID(N'dbo'),			-- will change to the sid of sa$NEWLINE$				0,							-- zero for old format, dgdef.[version],$NEWLINE$				dgdef.[lvalue]$NEWLINE$			from dbo.[dtproperties] dgnm$NEWLINE$				inner join dbo.[dtproperties] dggd on dggd.[property] = 'DtgSchemaGUID' and dggd.[objectid] = dgnm.[objectid]	$NEWLINE$				inner join dbo.[dtproperties] dgdef on dgdef.[property] = 'DtgSchemaDATA' and dgdef.[objectid] = dgnm.[objectid]$NEWLINE$				$NEWLINE$			where dgnm.[property] = 'DtgSchemaNAME' and dggd.[uvalue] like N'_EA3E6268-D998-11CE-9454-00AA00A3F36E_' $NEWLINE$			return 2;$NEWLINE$		end$NEWLINE$		return 1;$NEWLINE$	END$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for stored procedure Step_CopyFromActions : $NEWLINE$--$NEWLINE$GO$NEWLINE$SET ANSI_NULLS ON$NEWLINE$SET QUOTED_IDENTIFIER ON$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE PROCEDURE dbo.Step_CopyFromActions$NEWLINE$	@ActID uniqueidentifier,$NEWLINE$    @EmployeeID uniqueidentifier,$NEWLINE$    @OfficeID uniqueidentifier$NEWLINE$AS$NEWLINE$BEGIN$NEWLINE$  INSERT INTO dbo.Step(ActID, ActActionID, EmployeeID) $NEWLINE$  select @ActID, a.ActActionID, @EmployeeID$NEWLINE$  from ActAction a$NEWLINE$  where$NEWLINE$  	a.OfficeID = @OfficeID$NEWLINE$    and a.Hidden = 0$NEWLINE$  order by$NEWLINE$  	a.OrdNum  $NEWLINE$END$NEWLINE$GO$NEWLINE$$NEWLINE$IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'DropTableRecord')$NEWLINE$BEGIN$NEWLINE$	DROP PROCEDURE [dbo].[DropTableRecord]$NEWLINE$END$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE PROCEDURE [dbo].[DropTableRecord]$NEWLINE$	@TableName varchar(255),$NEWLINE$    @FieldName varchar(255),$NEWLINE$    @ID uniqueidentifier,$NEWLINE$    @IsEntryPoint bit = 0,$NEWLINE$    @OfficeID uniqueidentifier = NULL,$NEWLINE$    @TerminateProcess bit = 0 OUTPUT$NEWLINE$AS$NEWLINE$BEGIN$NEWLINE$$NEWLINE$IF @TerminateProcess = 1$NEWLINE$    RETURN$NEWLINE$$NEWLINE$/* Check for maximum recursion depth */$NEWLINE$IF @@NESTLEVEL = 32$NEWLINE$    RETURN$NEWLINE$    $NEWLINE$/* Set OfficeID as original ID */$NEWLINE$IF @OfficeID IS NULL AND @IsEntryPoint = 1$NEWLINE$	SET @OfficeID = @ID$NEWLINE$    $NEWLINE$/* Creating temporary table (need for recursion) if it's first proc launch*/$NEWLINE$IF @IsEntryPoint = 1$NEWLINE$BEGIN$NEWLINE$	IF OBJECT_ID('tempdb..#TmpDropTableRecord') IS NOT NULL $NEWLINE$		DROP TABLE #TmpDropTableRecord   $NEWLINE$    CREATE TABLE #TmpDropTableRecord ($NEWLINE$    	RecID int IDENTITY(1, 1) NOT NULL,$NEWLINE$        TableName varchar(255),$NEWLINE$        PKFieldName varchar(255),$NEWLINE$        ID uniqueidentifier,$NEWLINE$        OfficeID uniqueidentifier$NEWLINE$    )$NEWLINE$   $NEWLINE$	IF OBJECT_ID('tempdb..#ActDropTableRecord') IS NOT NULL $NEWLINE$		DROP TABLE #ActDropTableRecord   $NEWLINE$    CREATE TABLE #ActDropTableRecord ($NEWLINE$    	RecID int IDENTITY(1, 1) NOT NULL,$NEWLINE$        TableName varchar(255),$NEWLINE$        PKFieldName varchar(255),$NEWLINE$        ID uniqueidentifier$NEWLINE$    )    $NEWLINE$    $NEWLINE$	IF OBJECT_ID('tempdb..#CallStackDropTableRecord') IS NOT NULL $NEWLINE$		DROP TABLE #CallStackDropTableRecord   $NEWLINE$    CREATE TABLE #CallStackDropTableRecord ($NEWLINE$    	RecID int IDENTITY(1, 1) NOT NULL,$NEWLINE$        TableName varchar(255),$NEWLINE$        ID uniqueidentifier,$NEWLINE$        NestLevel int$NEWLINE$    )   $NEWLINE$	$NEWLINE$	IF OBJECT_ID('tempdb..#ExceptionTable') IS NOT NULL $NEWLINE$		DROP TABLE #ExceptionTable   $NEWLINE$    CREATE TABLE #ExceptionTable ($NEWLINE$        TableName varchar(255)$NEWLINE$    )    $NEWLINE$$NEWLINE$	insert into #ExceptionTable(TableName)$NEWLINE$	select 'Employee'$NEWLINE$	union all$NEWLINE$	select 'Office'$NEWLINE$END$NEWLINE$$NEWLINE$    INSERT INTO #CallStackDropTableRecord$NEWLINE$    VALUES (@TableName, @ID, @@NESTLEVEL)$NEWLINE$$NEWLINE$/* If source record already added for deleting then go away*/$NEWLINE$IF EXISTS ($NEWLINE$  	SELECT 0$NEWLINE$    FROM #ActDropTableRecord$NEWLINE$    WHERE TableName = @TableName AND PKFieldName = @FieldName AND ID = @ID$NEWLINE$)$NEWLINE$	RETURN    $NEWLINE$$NEWLINE$/* Collect all FK to [Office] table */$NEWLINE$DECLARE @LinksToOfficeTable TABLE ($NEWLINE$    LinkedTableName varchar(255),$NEWLINE$    LinkedFieldName varchar(255)$NEWLINE$)$NEWLINE$INSERT INTO @LinksToOfficeTable$NEWLINE$SELECT FK.TABLE_NAME, CU.COLUMN_NAME$NEWLINE$FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS FK ON C.CONSTRAINT_NAME = FK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK ON C.UNIQUE_CONSTRAINT_NAME = PK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE CU ON C.CONSTRAINT_NAME = CU.CONSTRAINT_NAME$NEWLINE$WHERE PK.TABLE_NAME = 'Office'$NEWLINE$$NEWLINE$/* Get the foreign keys with Tables list*/$NEWLINE$DECLARE @FK TABLE ($NEWLINE$    ID int IDENTITY(1, 1) NOT NULL,$NEWLINE$    ParentTableName varchar(255),    $NEWLINE$    ParentFieldName varchar(255), $NEWLINE$    TableName varchar(255),$NEWLINE$    FieldName varchar(255),$NEWLINE$    FKName varchar(255),$NEWLINE$    PKName varchar(255),$NEWLINE$    OfficeIDFieldName varchar(255)$NEWLINE$)$NEWLINE$$NEWLINE$INSERT INTO @FK(ParentTableName, ParentFieldName, TableName, FieldName, FKName, PKName, OfficeIDFieldName)$NEWLINE$SELECT PK.TABLE_NAME, PT.COLUMN_NAME, FK.TABLE_NAME, CU.COLUMN_NAME, C.CONSTRAINT_NAME, FPK.COLUMN_NAME, ISNULL(lct.LinkedFieldName, CLM.column_name)$NEWLINE$FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS FK ON C.CONSTRAINT_NAME = FK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK ON C.UNIQUE_CONSTRAINT_NAME = PK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE CU ON C.CONSTRAINT_NAME = CU.CONSTRAINT_NAME$NEWLINE$    INNER JOIN ($NEWLINE$        SELECT i1.TABLE_NAME, i2.COLUMN_NAME$NEWLINE$        FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS i1$NEWLINE$            INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE i2 ON i1.CONSTRAINT_NAME = i2.CONSTRAINT_NAME$NEWLINE$        WHERE i1.CONSTRAINT_TYPE = 'PRIMARY KEY'$NEWLINE$    ) PT ON PT.TABLE_NAME = PK.TABLE_NAME$NEWLINE$    INNER JOIN ($NEWLINE$        SELECT i1.TABLE_NAME, i2.COLUMN_NAME$NEWLINE$        FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS i1$NEWLINE$            INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE i2 ON i1.CONSTRAINT_NAME = i2.CONSTRAINT_NAME$NEWLINE$        WHERE i1.CONSTRAINT_TYPE = 'PRIMARY KEY'$NEWLINE$    ) FPK ON FPK.TABLE_NAME = FK.TABLE_NAME$NEWLINE$    LEFT JOIN INFORMATION_SCHEMA.[COLUMNS] CLM ON CLM.table_name = FK.TABLE_NAME AND LOWER(CLM.column_name) = 'OfficeID'$NEWLINE$    LEFT JOIN @LinksToOfficeTable lct ON lct.LinkedTableName = FK.TABLE_NAME$NEWLINE$    left join #ExceptionTable e on e.TableName = FK.TABLE_NAME$NEWLINE$WHERE PK.TABLE_NAME = @TableName AND C.DELETE_RULE <> 'CASCADE'$NEWLINE$	and e.TableName is null$NEWLINE$ORDER BY PK.TABLE_NAME, PT.COLUMN_NAME, FK.TABLE_NAME, CU.COLUMN_NAME  $NEWLINE$$NEWLINE$/* Generate script for getting all depended records from depended tables (via FK) */$NEWLINE$DECLARE @Script varchar(MAX)$NEWLINE$SET @Script = ''$NEWLINE$$NEWLINE$SELECT @Script = @Script + CHAR(13) + CHAR(10) +$NEWLINE$	CASE$NEWLINE$    	WHEN @Script = '' THEN ''$NEWLINE$        ELSE '  UNION ALL' + CHAR(13) + CHAR(10)$NEWLINE$    END$NEWLINE$    + '  SELECT ''' + TableName + ''' AS TableName, ''' + PKName +$NEWLINE$        ''' AS PKFieldName, ' + PKName + ' AS ID, ' +$NEWLINE$        CASE$NEWLINE$            WHEN OfficeIDFieldName IS NULL THEN 'NULL AS OfficeID'$NEWLINE$            ELSE OfficeIDFieldName + ' AS OfficeID'$NEWLINE$        END$NEWLINE$        + CHAR(13) + CHAR(10) +        $NEWLINE$    + '  FROM [' + TableName + ']'$NEWLINE$    + '  WHERE ' + FieldName + ' = ''' + CAST(@ID AS varchar(128)) + ''''$NEWLINE$FROM @FK    $NEWLINE$$NEWLINE$/* If there are no depended tables then go away */$NEWLINE$IF (@Script = '' and not exists (select 'x' from #ExceptionTable e where e.TableName = @TableName))$NEWLINE$BEGIN	$NEWLINE$    INSERT INTO #ActDropTableRecord(TableName, PKFieldName, ID)$NEWLINE$    VALUES (@TableName, @FieldName, @ID)        $NEWLINE$	RETURN    $NEWLINE$END$NEWLINE$    $NEWLINE$/* Getting first record (for knowing from which record start loop) */$NEWLINE$DECLARE @FromRecID int$NEWLINE$DECLARE @ToRecID int$NEWLINE$SELECT @FromRecID = ISNULL(MAX(RecID), 0) + 1 FROM #TmpDropTableRecord$NEWLINE$    $NEWLINE$/* Add depended records into tmp table */$NEWLINE$SET @Script =$NEWLINE$	'INSERT INTO #TmpDropTableRecord(TableName, PKFieldName, ID, OfficeID)' + CHAR(13) + CHAR(10)$NEWLINE$    + 'SELECT TableName, PKFieldName, ID, OfficeID' + CHAR(13) + CHAR(10)$NEWLINE$    + 'FROM (' + CHAR(13) + CHAR(10)$NEWLINE$    + @Script + CHAR(13) + CHAR(10)$NEWLINE$    + ') x' + CHAR(13) + CHAR(10)$NEWLINE$    + 'WHERE NOT EXISTS (' + CHAR(13) + CHAR(10)$NEWLINE$    + '  SELECT 0' + CHAR(13) + CHAR(10)$NEWLINE$    + '  FROM #ActDropTableRecord a' + CHAR(13) + CHAR(10)$NEWLINE$    + '  WHERE a.TableName = x.TableName AND a.PKFieldName = x.PKFieldName AND a.ID = x.ID' + CHAR(13) + CHAR(10)$NEWLINE$    + ')' + CHAR(13) + CHAR(10)$NEWLINE$$NEWLINE$$NEWLINE$$NEWLINE$EXEC(@Script)$NEWLINE$$NEWLINE$$NEWLINE$$NEWLINE$/* */$NEWLINE$DECLARE @ErrTableName varchar(255)$NEWLINE$DECLARE @ErrID uniqueidentifier$NEWLINE$DECLARE @ErrOfficeID uniqueidentifier$NEWLINE$$NEWLINE$SELECT @ErrTableName = TableName, @ErrID = ID, @ErrOfficeID = OfficeID$NEWLINE$FROM #TmpDropTableRecord$NEWLINE$WHERE OfficeID <> @OfficeID$NEWLINE$$NEWLINE$IF @ErrTableName IS NOT NULL$NEWLINE$BEGIN$NEWLINE$    SET @TerminateProcess = 1$NEWLINE$    $NEWLINE$    DECLARE @CallStack varchar(MAX)$NEWLINE$    SET @CallStack = ''$NEWLINE$    SELECT @CallStack = @CallStack + CHAR(13) + CHAR(10)$NEWLINE$        + REPLICATE(' ', NestLevel) + '-> ' + TableName + '(ID = ''' + CAST(ID AS varchar(128)) + ''')'$NEWLINE$    FROM #CallStackDropTableRecord$NEWLINE$    ORDER BY RecID$NEWLINE$    PRINT @CallStack$NEWLINE$    $NEWLINE$	DECLARE @ErrMessage varchar(255)$NEWLINE$    SET @ErrMessage = 'Another OfficeID found (''' + CAST(@ErrOfficeID AS varchar(128)) + ''') in table [' + @ErrTableName + '], ID = ''' + CAST(@ErrID AS varchar(128)) + ''''$NEWLINE$    RAISERROR(@ErrMessage, 16, 1)$NEWLINE$    RETURN$NEWLINE$END$NEWLINE$$NEWLINE$/* Getting last record (for knowing to which record loop cursor)*/$NEWLINE$SELECT @ToRecID = ISNULL(MAX(RecID), 0) FROM #TmpDropTableRecord$NEWLINE$$NEWLINE$/* If there are no depended records then go away*/$NEWLINE$IF (@FromRecID > @ToRecID and not exists (select 'x' from #ExceptionTable e where e.TableName = @TableName))$NEWLINE$BEGIN	$NEWLINE$    INSERT INTO #ActDropTableRecord(TableName, PKFieldName, ID)$NEWLINE$    VALUES (@TableName, @FieldName, @ID)      $NEWLINE$	RETURN    $NEWLINE$END$NEWLINE$$NEWLINE$/* Logging Progress */$NEWLINE$IF @IsEntryPoint = 1$NEWLINE$BEGIN$NEWLINE$	DECLARE @CurrentDepIndex int$NEWLINE$    SET @CurrentDepIndex = 0$NEWLINE$    DECLARE @Progress int$NEWLINE$    SET @Progress = 0$NEWLINE$	DECLARE @DepCount int$NEWLINE$    SELECT @DepCount = COUNT(*)$NEWLINE$    FROM #TmpDropTableRecord$NEWLINE$END$NEWLINE$    $NEWLINE$$NEWLINE$/* Initialize loop*/$NEWLINE$DECLARE @cTableName varchar(255)$NEWLINE$DECLARE @cPKFieldName varchar(255)$NEWLINE$DECLARE @cID uniqueidentifier$NEWLINE$$NEWLINE$DECLARE @cur CURSOR$NEWLINE$SET @cur = CURSOR FOR$NEWLINE$    SELECT TableName, PKFieldName, ID$NEWLINE$    FROM #TmpDropTableRecord$NEWLINE$    WHERE RecID BETWEEN @FromRecID AND @ToRecID$NEWLINE$$NEWLINE$OPEN @cur$NEWLINE$$NEWLINE$FETCH NEXT FROM @cur $NEWLINE$INTO @cTableName, @cPKFieldName, @cID$NEWLINE$$NEWLINE$WHILE @@FETCH_STATUS = 0$NEWLINE$BEGIN$NEWLINE$	EXEC DropTableRecord @cTableName, @cPKFieldName, @cID, 0, @OfficeID, @TerminateProcess OUTPUT  /* <-- Recursion here! */   $NEWLINE$	DELETE$NEWLINE$    FROM #CallStackDropTableRecord$NEWLINE$    WHERE TableName = @cTableName AND ID = @cID  $NEWLINE$$NEWLINE$    IF @TerminateProcess = 1$NEWLINE$        RETURN$NEWLINE$    $NEWLINE$    IF @IsEntryPoint = 1$NEWLINE$	BEGIN$NEWLINE$    	SET @CurrentDepIndex = @CurrentDepIndex + 1$NEWLINE$        SET @Progress = ROUND((CAST(@CurrentDepIndex AS numeric(15, 0)) / @DepCount) * 100, 0)$NEWLINE$        IF @Progress = 100$NEWLINE$        	SET @Progress = 99$NEWLINE$    END$NEWLINE$$NEWLINE$    FETCH NEXT FROM @cur $NEWLINE$    INTO @cTableName, @cPKFieldName, @cID$NEWLINE$END$NEWLINE$$NEWLINE$CLOSE @cur$NEWLINE$DEALLOCATE @cur$NEWLINE$$NEWLINE$$NEWLINE$/* Add to delete current record (it is assumed that all depended records has been deleted)*/$NEWLINE$IF (NOT EXISTS ($NEWLINE$  	SELECT 0$NEWLINE$    FROM #ActDropTableRecord$NEWLINE$    WHERE TableName = @TableName AND PKFieldName = @FieldName AND ID = @ID$NEWLINE$	) and not exists (select 'x' from #ExceptionTable e where e.TableName = @TableName))$NEWLINE$	INSERT INTO #ActDropTableRecord(TableName, PKFieldName, ID)$NEWLINE$	VALUES (@TableName, @FieldName, @ID)    $NEWLINE$    $NEWLINE$DELETE$NEWLINE$FROM #CallStackDropTableRecord$NEWLINE$WHERE TableName = @TableName AND ID = @ID       $NEWLINE$$NEWLINE$IF @IsEntryPoint = 1$NEWLINE$BEGIN$NEWLINE$   $NEWLINE$    SELECT @DepCount = COUNT(*)$NEWLINE$    FROM #ActDropTableRecord$NEWLINE$    $NEWLINE$    SET @CurrentDepIndex = 0$NEWLINE$    SET @Progress = 0;$NEWLINE$    $NEWLINE$    SET @cur = CURSOR FOR$NEWLINE$        SELECT t.TableName, t.PKFieldName, t.ID$NEWLINE$        FROM #ActDropTableRecord t $NEWLINE$		left join #ExceptionTable et on et.TableName = t.TableName$NEWLINE$		where$NEWLINE$			 et.TableName is null$NEWLINE$        ORDER BY RecID$NEWLINE$$NEWLINE$    OPEN @cur$NEWLINE$$NEWLINE$    FETCH NEXT FROM @cur $NEWLINE$    INTO @cTableName, @cPKFieldName, @cID$NEWLINE$$NEWLINE$    WHILE @@FETCH_STATUS = 0$NEWLINE$    BEGIN$NEWLINE$        PRINT 'Deleting from [' + @cTableName + '], ID = ''' + CAST(@cID AS varchar(128)) + ''''$NEWLINE$        SET @Script = 'DELETE FROM [' + @cTableName + '] WHERE '$NEWLINE$        	+ @cPKFieldName + ' = ''' + CAST(@cID AS varchar(128)) + ''''$NEWLINE$        EXEC(@Script)$NEWLINE$        $NEWLINE$        /* Logging*/$NEWLINE$        SET @CurrentDepIndex = @CurrentDepIndex + 1$NEWLINE$        SET @Progress = ROUND((CAST(@CurrentDepIndex AS numeric(15, 0)) / @DepCount) * 100, 0)$NEWLINE$$NEWLINE$        FETCH NEXT FROM @cur $NEWLINE$        INTO @cTableName, @cPKFieldName, @cID$NEWLINE$    END$NEWLINE$$NEWLINE$    CLOSE @cur$NEWLINE$    DEALLOCATE @cur    $NEWLINE$    $NEWLINE$	DROP TABLE #ActDropTableRecord$NEWLINE$	DROP TABLE #TmpDropTableRecord$NEWLINE$    DROP TABLE #CallStackDropTableRecord$NEWLINE$END$NEWLINE$$NEWLINE$END$NEWLINE$$NEWLINE$GO$NEWLINE$$NEWLINE$$NEWLINE$--$NEWLINE$-- Data for table dbo.DocumentValue  (LIMIT 0,500)$NEWLINE$--$NEWLINE$$NEWLINE$INSERT INTO [dbo].[DocumentValue] ([DocumentValueID], [ValueSetID], [DocValue], [DocColor])$NEWLINE$VALUES $NEWLINE$  (N'{2727F2A8-F853-473B-ACF9-45D413861EA7}', N'{DB760580-D1AF-4354-842D-D4FAD5660895}', N'Так', -16728064)$NEWLINE$GO$NEWLINE$$NEWLINE$INSERT INTO [dbo].[DocumentValue] ([DocumentValueID], [ValueSetID], [DocValue], [DocColor])$NEWLINE$VALUES $NEWLINE$  (N'{FF231F64-288F-44DA-B6F8-C4747363312D}', N'{1D10DCDF-523C-4173-B518-BB4FBF615782}', N'Так', -16728064)$NEWLINE$GO$NEWLINE$$NEWLINE$INSERT INTO [dbo].[DocumentValue] ([DocumentValueID], [ValueSetID], [DocValue], [DocColor])$NEWLINE$VALUES $NEWLINE$  (N'{1D409EE9-94BE-4A5C-B3D6-C5C436269F69}', N'{1D10DCDF-523C-4173-B518-BB4FBF615782}', N'Ні', -65536)$NEWLINE$GO$NEWLINE$$NEWLINE$INSERT INTO [dbo].[DocumentValue] ([DocumentValueID], [ValueSetID], [DocValue], [DocColor])$NEWLINE$VALUES $NEWLINE$  (N'{C70FBB53-3DDA-4B62-9C87-CBB0B35EEFD0}', N'{DB760580-D1AF-4354-842D-D4FAD5660895}', N'Ні', -65536)$NEWLINE$GO$NEWLINE$$NEWLINE$INSERT INTO [dbo].[DocumentValue] ([DocumentValueID], [ValueSetID], [DocValue], [DocColor])$NEWLINE$VALUES $NEWLINE$  (N'{5433763D-0E83-4B4F-9048-D1E9522904EE}', N'{1D10DCDF-523C-4173-B518-BB4FBF615782}', N'З', -256)$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Data for table dbo.ValueSet  (LIMIT 0,500)$NEWLINE$--$NEWLINE$$NEWLINE$INSERT INTO [dbo].[ValueSet] ([ValueSetID], [SetName])$NEWLINE$VALUES $NEWLINE$  (N'{1D10DCDF-523C-4173-B518-BB4FBF615782}', N'Так/Ні/З')$NEWLINE$GO$NEWLINE$$NEWLINE$INSERT INTO [dbo].[ValueSet] ([ValueSetID], [SetName])$NEWLINE$VALUES $NEWLINE$  (N'{DB760580-D1AF-4354-842D-D4FAD5660895}', N'Так/Ні')$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for indices : $NEWLINE$--$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Category]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([CategoryID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Office]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([OfficeID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = ON,$NEWLINE$  ALLOW_PAGE_LOCKS = ON)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[TerritorialUnit]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([TerritorialUnitID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Employee]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([EmployeeID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = ON,$NEWLINE$  ALLOW_PAGE_LOCKS = ON)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Act]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([ActID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActAction]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([ActActionID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ValueSet]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([ValueSetID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[DocumentValue]$NEWLINE$ADD CONSTRAINT [PK_DocumentValue] $NEWLINE$PRIMARY KEY CLUSTERED ([DocumentValueID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[DocumentGroup]$NEWLINE$ADD CONSTRAINT [PK_DocumentGroup] $NEWLINE$PRIMARY KEY CLUSTERED ([DocumentGroupID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Document]$NEWLINE$ADD CONSTRAINT [PK_Document] $NEWLINE$PRIMARY KEY CLUSTERED ([DocumentID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActDocument]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([ActDocumentID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActHistory]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([ActHistoryID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Cost]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([CostID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Expense]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([ExpenseID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ExpenseCost]$NEWLINE$ADD CONSTRAINT [PK_ExpenceCost_] $NEWLINE$PRIMARY KEY CLUSTERED ([ExpenseID], [CostID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = ON,$NEWLINE$  ALLOW_PAGE_LOCKS = ON)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Layout]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([LayoutID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Note]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([NoteID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[PaymentDataSettings]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([PaymentDataSettingsID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[State]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([StateID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[StateHistory]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([StateHistoryID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Step]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([StepID])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = OFF,$NEWLINE$  ALLOW_PAGE_LOCKS = OFF)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[sysdiagrams]$NEWLINE$ADD PRIMARY KEY CLUSTERED ([diagram_id])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = ON,$NEWLINE$  ALLOW_PAGE_LOCKS = ON)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[sysdiagrams]$NEWLINE$ADD CONSTRAINT [UK_principal_name] $NEWLINE$UNIQUE NONCLUSTERED ([principal_id], [name])$NEWLINE$WITH ($NEWLINE$  PAD_INDEX = OFF,$NEWLINE$  IGNORE_DUP_KEY = OFF,$NEWLINE$  STATISTICS_NORECOMPUTE = OFF,$NEWLINE$  ALLOW_ROW_LOCKS = ON,$NEWLINE$  ALLOW_PAGE_LOCKS = ON)$NEWLINE$ON [PRIMARY]$NEWLINE$GO$NEWLINE$$NEWLINE$--$NEWLINE$-- Definition for foreign keys : $NEWLINE$--$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[TerritorialUnit]$NEWLINE$ADD CONSTRAINT [FK_TerritorialUnit_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[TerritorialUnit]$NEWLINE$ADD CONSTRAINT [FK_TerritorialUnit_TerritorialUnit_ParentID] FOREIGN KEY ([ParentID]) $NEWLINE$  REFERENCES [dbo].[TerritorialUnit] ([TerritorialUnitID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Employee]$NEWLINE$ADD CONSTRAINT [FK_Employee_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Act]$NEWLINE$ADD CONSTRAINT [FK_Act_Category_CategoryID] FOREIGN KEY ([CategoryID]) $NEWLINE$  REFERENCES [dbo].[Category] ([CategoryID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Act]$NEWLINE$ADD CONSTRAINT [FK_Act_Employee_EmployeeID] FOREIGN KEY ([EmployeeID]) $NEWLINE$  REFERENCES [dbo].[Employee] ([EmployeeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Act]$NEWLINE$ADD CONSTRAINT [FK_Act_TerritorialUnit_TerritorialUnitID] FOREIGN KEY ([TerritorialUnitID]) $NEWLINE$  REFERENCES [dbo].[TerritorialUnit] ([TerritorialUnitID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActAction]$NEWLINE$ADD CONSTRAINT [FK_ActAction_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[DocumentValue]$NEWLINE$ADD CONSTRAINT [FK_DocumentValue_ValueSet_ValueSetID] FOREIGN KEY ([ValueSetID]) $NEWLINE$  REFERENCES [dbo].[ValueSet] ([ValueSetID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[DocumentGroup]$NEWLINE$ADD CONSTRAINT [FK_DocumentGroup_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Document]$NEWLINE$ADD CONSTRAINT [FK_Document_DocumentGroup_DocumentGroupID] FOREIGN KEY ([DocumentGroupID]) $NEWLINE$  REFERENCES [dbo].[DocumentGroup] ([DocumentGroupID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Document]$NEWLINE$ADD CONSTRAINT [FK_Document_ValueSet_ValueSetID] FOREIGN KEY ([ValueSetID]) $NEWLINE$  REFERENCES [dbo].[ValueSet] ([ValueSetID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActDocument]$NEWLINE$ADD CONSTRAINT [FK_ActDocument_Act_ActID] FOREIGN KEY ([ActID]) $NEWLINE$  REFERENCES [dbo].[Act] ([ActID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActDocument]$NEWLINE$ADD CONSTRAINT [FK_ActDocument_Document_DocumentID] FOREIGN KEY ([DocumentID]) $NEWLINE$  REFERENCES [dbo].[Document] ([DocumentID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActDocument]$NEWLINE$ADD CONSTRAINT [FK_ActDocument_DocumentValue_DocumentValueID] FOREIGN KEY ([DocumentValueID]) $NEWLINE$  REFERENCES [dbo].[DocumentValue] ([DocumentValueID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActHistory]$NEWLINE$ADD CONSTRAINT [FK_ActHistory_Act_ActID] FOREIGN KEY ([ActID]) $NEWLINE$  REFERENCES [dbo].[Act] ([ActID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ActHistory]$NEWLINE$ADD CONSTRAINT [FK_ActHistory_Employee_EmployeeID] FOREIGN KEY ([EmployeeID]) $NEWLINE$  REFERENCES [dbo].[Employee] ([EmployeeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Cost]$NEWLINE$ADD CONSTRAINT [FK_CostID_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Expense]$NEWLINE$ADD CONSTRAINT [FK_Expense_Employee_EmployeeID] FOREIGN KEY ([EmployeeID]) $NEWLINE$  REFERENCES [dbo].[Employee] ([EmployeeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ExpenseCost]$NEWLINE$ADD CONSTRAINT [FK_ExprenceCost_Cost_CostID] FOREIGN KEY ([CostID]) $NEWLINE$  REFERENCES [dbo].[Cost] ([CostID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[ExpenseCost]$NEWLINE$ADD CONSTRAINT [FK_ExprenceCost_Expense_ExprenseID] FOREIGN KEY ([ExpenseID]) $NEWLINE$  REFERENCES [dbo].[Expense] ([ExpenseID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Layout]$NEWLINE$ADD CONSTRAINT [FK_Layout_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Note]$NEWLINE$ADD CONSTRAINT [FK_Note_Act_ActID] FOREIGN KEY ([ActID]) $NEWLINE$  REFERENCES [dbo].[Act] ([ActID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Note]$NEWLINE$ADD CONSTRAINT [FK_Note_Employee_EmployeeID] FOREIGN KEY ([EmployeeID]) $NEWLINE$  REFERENCES [dbo].[Employee] ([EmployeeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[PaymentDataSettings]$NEWLINE$ADD CONSTRAINT [FK_PaymentDataSettings_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[State]$NEWLINE$ADD CONSTRAINT [FK_State_Office_OfficeID] FOREIGN KEY ([OfficeID]) $NEWLINE$  REFERENCES [dbo].[Office] ([OfficeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[StateHistory]$NEWLINE$ADD CONSTRAINT [FK_StateHistory_Act_ActID] FOREIGN KEY ([ActID]) $NEWLINE$  REFERENCES [dbo].[Act] ([ActID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[StateHistory]$NEWLINE$ADD CONSTRAINT [FK_StateHistory_Employee_EmployeeID] FOREIGN KEY ([EmployeeID]) $NEWLINE$  REFERENCES [dbo].[Employee] ([EmployeeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[StateHistory]$NEWLINE$ADD CONSTRAINT [FK_StateHistory_State_StateID] FOREIGN KEY ([StateID]) $NEWLINE$  REFERENCES [dbo].[State] ([StateID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Step]$NEWLINE$ADD CONSTRAINT [FK_Step_Act_ActID] FOREIGN KEY ([ActID]) $NEWLINE$  REFERENCES [dbo].[Act] ([ActID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE CASCADE$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Step]$NEWLINE$ADD CONSTRAINT [FK_Step_ActAction_ActActionID] FOREIGN KEY ([ActActionID]) $NEWLINE$  REFERENCES [dbo].[ActAction] ([ActActionID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$ALTER TABLE [dbo].[Step]$NEWLINE$ADD CONSTRAINT [FK_Step_Employee_EmployeeID] FOREIGN KEY ([EmployeeID]) $NEWLINE$  REFERENCES [dbo].[Employee] ([EmployeeID]) $NEWLINE$  ON UPDATE NO ACTION$NEWLINE$  ON DELETE NO ACTION$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE LOGIN [dbuser] WITH PASSWORD = N'qwe@poi1' ,$NEWLINE$  CHECK_POLICY = OFF,$NEWLINE$  CHECK_EXPIRATION = OFF$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE USER [dbuser] FOR LOGIN [dbuser] $NEWLINE$GO$NEWLINE$$NEWLINE$EXEC sp_addrolemember N'db_owner', N'dbuser'$NEWLINE$GO$NEWLINE$",-1,0
mMSSQLIDE.dll\mMSSQLExec.dll
{D1CABA7D-F2AA-431F-9EC6-91D0F1018DDF}
.,SQLKFL,Kayflow,sa,qwe@poi1,DBEXISTS,,0,0
mMSSQLIDE.dll\mMSSQLExec.dll
{B5BB452E-208D-4D61-BBAB-96FA07FBD467}
.,SQLKFL,Kayflow,sa,qwe@poi1,SUCCESS,"IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'DropTableRecord')$NEWLINE$BEGIN$NEWLINE$	DROP PROCEDURE [dbo].[DropTableRecord]$NEWLINE$END$NEWLINE$GO$NEWLINE$$NEWLINE$CREATE PROCEDURE [dbo].[DropTableRecord]$NEWLINE$	@TableName varchar(255),$NEWLINE$    @FieldName varchar(255),$NEWLINE$    @ID uniqueidentifier,$NEWLINE$    @IsEntryPoint bit = 0,$NEWLINE$    @OfficeID uniqueidentifier = NULL,$NEWLINE$    @TerminateProcess bit = 0 OUTPUT$NEWLINE$AS$NEWLINE$BEGIN$NEWLINE$$NEWLINE$IF @TerminateProcess = 1$NEWLINE$    RETURN$NEWLINE$$NEWLINE$/* Check for maximum recursion depth */$NEWLINE$IF @@NESTLEVEL = 32$NEWLINE$    RETURN$NEWLINE$    $NEWLINE$/* Set OfficeID as original ID */$NEWLINE$IF @OfficeID IS NULL AND @IsEntryPoint = 1$NEWLINE$	SET @OfficeID = @ID$NEWLINE$    $NEWLINE$/* Creating temporary table (need for recursion) if it's first proc launch*/$NEWLINE$IF @IsEntryPoint = 1$NEWLINE$BEGIN$NEWLINE$	IF OBJECT_ID('tempdb..#TmpDropTableRecord') IS NOT NULL $NEWLINE$		DROP TABLE #TmpDropTableRecord   $NEWLINE$    CREATE TABLE #TmpDropTableRecord ($NEWLINE$    	RecID int IDENTITY(1, 1) NOT NULL,$NEWLINE$        TableName varchar(255),$NEWLINE$        PKFieldName varchar(255),$NEWLINE$        ID uniqueidentifier,$NEWLINE$        OfficeID uniqueidentifier$NEWLINE$    )$NEWLINE$   $NEWLINE$	IF OBJECT_ID('tempdb..#ActDropTableRecord') IS NOT NULL $NEWLINE$		DROP TABLE #ActDropTableRecord   $NEWLINE$    CREATE TABLE #ActDropTableRecord ($NEWLINE$    	RecID int IDENTITY(1, 1) NOT NULL,$NEWLINE$        TableName varchar(255),$NEWLINE$        PKFieldName varchar(255),$NEWLINE$        ID uniqueidentifier$NEWLINE$    )    $NEWLINE$    $NEWLINE$	IF OBJECT_ID('tempdb..#CallStackDropTableRecord') IS NOT NULL $NEWLINE$		DROP TABLE #CallStackDropTableRecord   $NEWLINE$    CREATE TABLE #CallStackDropTableRecord ($NEWLINE$    	RecID int IDENTITY(1, 1) NOT NULL,$NEWLINE$        TableName varchar(255),$NEWLINE$        ID uniqueidentifier,$NEWLINE$        NestLevel int$NEWLINE$    )   $NEWLINE$	$NEWLINE$	IF OBJECT_ID('tempdb..#ExceptionTable') IS NOT NULL $NEWLINE$		DROP TABLE #ExceptionTable   $NEWLINE$    CREATE TABLE #ExceptionTable ($NEWLINE$        TableName varchar(255)$NEWLINE$    )    $NEWLINE$$NEWLINE$	insert into #ExceptionTable(TableName)$NEWLINE$	select 'Employee'$NEWLINE$	union all$NEWLINE$	select 'Office'$NEWLINE$END$NEWLINE$$NEWLINE$    INSERT INTO #CallStackDropTableRecord$NEWLINE$    VALUES (@TableName, @ID, @@NESTLEVEL)$NEWLINE$$NEWLINE$/* If source record already added for deleting then go away*/$NEWLINE$IF EXISTS ($NEWLINE$  	SELECT 0$NEWLINE$    FROM #ActDropTableRecord$NEWLINE$    WHERE TableName = @TableName AND PKFieldName = @FieldName AND ID = @ID$NEWLINE$)$NEWLINE$	RETURN    $NEWLINE$$NEWLINE$/* Collect all FK to [Office] table */$NEWLINE$DECLARE @LinksToOfficeTable TABLE ($NEWLINE$    LinkedTableName varchar(255),$NEWLINE$    LinkedFieldName varchar(255)$NEWLINE$)$NEWLINE$INSERT INTO @LinksToOfficeTable$NEWLINE$SELECT FK.TABLE_NAME, CU.COLUMN_NAME$NEWLINE$FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS FK ON C.CONSTRAINT_NAME = FK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK ON C.UNIQUE_CONSTRAINT_NAME = PK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE CU ON C.CONSTRAINT_NAME = CU.CONSTRAINT_NAME$NEWLINE$WHERE PK.TABLE_NAME = 'Office'$NEWLINE$$NEWLINE$/* Get the foreign keys with Tables list*/$NEWLINE$DECLARE @FK TABLE ($NEWLINE$    ID int IDENTITY(1, 1) NOT NULL,$NEWLINE$    ParentTableName varchar(255),    $NEWLINE$    ParentFieldName varchar(255), $NEWLINE$    TableName varchar(255),$NEWLINE$    FieldName varchar(255),$NEWLINE$    FKName varchar(255),$NEWLINE$    PKName varchar(255),$NEWLINE$    OfficeIDFieldName varchar(255)$NEWLINE$)$NEWLINE$$NEWLINE$INSERT INTO @FK(ParentTableName, ParentFieldName, TableName, FieldName, FKName, PKName, OfficeIDFieldName)$NEWLINE$SELECT PK.TABLE_NAME, PT.COLUMN_NAME, FK.TABLE_NAME, CU.COLUMN_NAME, C.CONSTRAINT_NAME, FPK.COLUMN_NAME, ISNULL(lct.LinkedFieldName, CLM.column_name)$NEWLINE$FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS FK ON C.CONSTRAINT_NAME = FK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK ON C.UNIQUE_CONSTRAINT_NAME = PK.CONSTRAINT_NAME$NEWLINE$    INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE CU ON C.CONSTRAINT_NAME = CU.CONSTRAINT_NAME$NEWLINE$    INNER JOIN ($NEWLINE$        SELECT i1.TABLE_NAME, i2.COLUMN_NAME$NEWLINE$        FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS i1$NEWLINE$            INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE i2 ON i1.CONSTRAINT_NAME = i2.CONSTRAINT_NAME$NEWLINE$        WHERE i1.CONSTRAINT_TYPE = 'PRIMARY KEY'$NEWLINE$    ) PT ON PT.TABLE_NAME = PK.TABLE_NAME$NEWLINE$    INNER JOIN ($NEWLINE$        SELECT i1.TABLE_NAME, i2.COLUMN_NAME$NEWLINE$        FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS i1$NEWLINE$            INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE i2 ON i1.CONSTRAINT_NAME = i2.CONSTRAINT_NAME$NEWLINE$        WHERE i1.CONSTRAINT_TYPE = 'PRIMARY KEY'$NEWLINE$    ) FPK ON FPK.TABLE_NAME = FK.TABLE_NAME$NEWLINE$    LEFT JOIN INFORMATION_SCHEMA.[COLUMNS] CLM ON CLM.table_name = FK.TABLE_NAME AND LOWER(CLM.column_name) = 'OfficeID'$NEWLINE$    LEFT JOIN @LinksToOfficeTable lct ON lct.LinkedTableName = FK.TABLE_NAME$NEWLINE$    left join #ExceptionTable e on e.TableName = FK.TABLE_NAME$NEWLINE$WHERE PK.TABLE_NAME = @TableName AND C.DELETE_RULE <> 'CASCADE'$NEWLINE$	and e.TableName is null$NEWLINE$ORDER BY PK.TABLE_NAME, PT.COLUMN_NAME, FK.TABLE_NAME, CU.COLUMN_NAME  $NEWLINE$$NEWLINE$/* Generate script for getting all depended records from depended tables (via FK) */$NEWLINE$DECLARE @Script varchar(MAX)$NEWLINE$SET @Script = ''$NEWLINE$$NEWLINE$SELECT @Script = @Script + CHAR(13) + CHAR(10) +$NEWLINE$	CASE$NEWLINE$    	WHEN @Script = '' THEN ''$NEWLINE$        ELSE '  UNION ALL' + CHAR(13) + CHAR(10)$NEWLINE$    END$NEWLINE$    + '  SELECT ''' + TableName + ''' AS TableName, ''' + PKName +$NEWLINE$        ''' AS PKFieldName, ' + PKName + ' AS ID, ' +$NEWLINE$        CASE$NEWLINE$            WHEN OfficeIDFieldName IS NULL THEN 'NULL AS OfficeID'$NEWLINE$            ELSE OfficeIDFieldName + ' AS OfficeID'$NEWLINE$        END$NEWLINE$        + CHAR(13) + CHAR(10) +        $NEWLINE$    + '  FROM [' + TableName + ']'$NEWLINE$    + '  WHERE ' + FieldName + ' = ''' + CAST(@ID AS varchar(128)) + ''''$NEWLINE$FROM @FK    $NEWLINE$$NEWLINE$/* If there are no depended tables then go away */$NEWLINE$IF (@Script = '' and not exists (select 'x' from #ExceptionTable e where e.TableName = @TableName))$NEWLINE$BEGIN	$NEWLINE$    INSERT INTO #ActDropTableRecord(TableName, PKFieldName, ID)$NEWLINE$    VALUES (@TableName, @FieldName, @ID)        $NEWLINE$	RETURN    $NEWLINE$END$NEWLINE$    $NEWLINE$/* Getting first record (for knowing from which record start loop) */$NEWLINE$DECLARE @FromRecID int$NEWLINE$DECLARE @ToRecID int$NEWLINE$SELECT @FromRecID = ISNULL(MAX(RecID), 0) + 1 FROM #TmpDropTableRecord$NEWLINE$    $NEWLINE$/* Add depended records into tmp table */$NEWLINE$SET @Script =$NEWLINE$	'INSERT INTO #TmpDropTableRecord(TableName, PKFieldName, ID, OfficeID)' + CHAR(13) + CHAR(10)$NEWLINE$    + 'SELECT TableName, PKFieldName, ID, OfficeID' + CHAR(13) + CHAR(10)$NEWLINE$    + 'FROM (' + CHAR(13) + CHAR(10)$NEWLINE$    + @Script + CHAR(13) + CHAR(10)$NEWLINE$    + ') x' + CHAR(13) + CHAR(10)$NEWLINE$    + 'WHERE NOT EXISTS (' + CHAR(13) + CHAR(10)$NEWLINE$    + '  SELECT 0' + CHAR(13) + CHAR(10)$NEWLINE$    + '  FROM #ActDropTableRecord a' + CHAR(13) + CHAR(10)$NEWLINE$    + '  WHERE a.TableName = x.TableName AND a.PKFieldName = x.PKFieldName AND a.ID = x.ID' + CHAR(13) + CHAR(10)$NEWLINE$    + ')' + CHAR(13) + CHAR(10)$NEWLINE$$NEWLINE$$NEWLINE$$NEWLINE$EXEC(@Script)$NEWLINE$$NEWLINE$$NEWLINE$$NEWLINE$/* */$NEWLINE$DECLARE @ErrTableName varchar(255)$NEWLINE$DECLARE @ErrID uniqueidentifier$NEWLINE$DECLARE @ErrOfficeID uniqueidentifier$NEWLINE$$NEWLINE$SELECT @ErrTableName = TableName, @ErrID = ID, @ErrOfficeID = OfficeID$NEWLINE$FROM #TmpDropTableRecord$NEWLINE$WHERE OfficeID <> @OfficeID$NEWLINE$$NEWLINE$IF @ErrTableName IS NOT NULL$NEWLINE$BEGIN$NEWLINE$    SET @TerminateProcess = 1$NEWLINE$    $NEWLINE$    DECLARE @CallStack varchar(MAX)$NEWLINE$    SET @CallStack = ''$NEWLINE$    SELECT @CallStack = @CallStack + CHAR(13) + CHAR(10)$NEWLINE$        + REPLICATE(' ', NestLevel) + '-> ' + TableName + '(ID = ''' + CAST(ID AS varchar(128)) + ''')'$NEWLINE$    FROM #CallStackDropTableRecord$NEWLINE$    ORDER BY RecID$NEWLINE$    PRINT @CallStack$NEWLINE$    $NEWLINE$	DECLARE @ErrMessage varchar(255)$NEWLINE$    SET @ErrMessage = 'Another OfficeID found (''' + CAST(@ErrOfficeID AS varchar(128)) + ''') in table [' + @ErrTableName + '], ID = ''' + CAST(@ErrID AS varchar(128)) + ''''$NEWLINE$    RAISERROR(@ErrMessage, 16, 1)$NEWLINE$    RETURN$NEWLINE$END$NEWLINE$$NEWLINE$/* Getting last record (for knowing to which record loop cursor)*/$NEWLINE$SELECT @ToRecID = ISNULL(MAX(RecID), 0) FROM #TmpDropTableRecord$NEWLINE$$NEWLINE$/* If there are no depended records then go away*/$NEWLINE$IF (@FromRecID > @ToRecID and not exists (select 'x' from #ExceptionTable e where e.TableName = @TableName))$NEWLINE$BEGIN	$NEWLINE$    INSERT INTO #ActDropTableRecord(TableName, PKFieldName, ID)$NEWLINE$    VALUES (@TableName, @FieldName, @ID)      $NEWLINE$	RETURN    $NEWLINE$END$NEWLINE$$NEWLINE$/* Logging Progress */$NEWLINE$IF @IsEntryPoint = 1$NEWLINE$BEGIN$NEWLINE$	DECLARE @CurrentDepIndex int$NEWLINE$    SET @CurrentDepIndex = 0$NEWLINE$    DECLARE @Progress int$NEWLINE$    SET @Progress = 0$NEWLINE$	DECLARE @DepCount int$NEWLINE$    SELECT @DepCount = COUNT(*)$NEWLINE$    FROM #TmpDropTableRecord$NEWLINE$END$NEWLINE$    $NEWLINE$$NEWLINE$/* Initialize loop*/$NEWLINE$DECLARE @cTableName varchar(255)$NEWLINE$DECLARE @cPKFieldName varchar(255)$NEWLINE$DECLARE @cID uniqueidentifier$NEWLINE$$NEWLINE$DECLARE @cur CURSOR$NEWLINE$SET @cur = CURSOR FOR$NEWLINE$    SELECT TableName, PKFieldName, ID$NEWLINE$    FROM #TmpDropTableRecord$NEWLINE$    WHERE RecID BETWEEN @FromRecID AND @ToRecID$NEWLINE$$NEWLINE$OPEN @cur$NEWLINE$$NEWLINE$FETCH NEXT FROM @cur $NEWLINE$INTO @cTableName, @cPKFieldName, @cID$NEWLINE$$NEWLINE$WHILE @@FETCH_STATUS = 0$NEWLINE$BEGIN$NEWLINE$	EXEC DropTableRecord @cTableName, @cPKFieldName, @cID, 0, @OfficeID, @TerminateProcess OUTPUT  /* <-- Recursion here! */   $NEWLINE$	DELETE$NEWLINE$    FROM #CallStackDropTableRecord$NEWLINE$    WHERE TableName = @cTableName AND ID = @cID  $NEWLINE$$NEWLINE$    IF @TerminateProcess = 1$NEWLINE$        RETURN$NEWLINE$    $NEWLINE$    IF @IsEntryPoint = 1$NEWLINE$	BEGIN$NEWLINE$    	SET @CurrentDepIndex = @CurrentDepIndex + 1$NEWLINE$        SET @Progress = ROUND((CAST(@CurrentDepIndex AS numeric(15, 0)) / @DepCount) * 100, 0)$NEWLINE$        IF @Progress = 100$NEWLINE$        	SET @Progress = 99$NEWLINE$    END$NEWLINE$$NEWLINE$    FETCH NEXT FROM @cur $NEWLINE$    INTO @cTableName, @cPKFieldName, @cID$NEWLINE$END$NEWLINE$$NEWLINE$CLOSE @cur$NEWLINE$DEALLOCATE @cur$NEWLINE$$NEWLINE$$NEWLINE$/* Add to delete current record (it is assumed that all depended records has been deleted)*/$NEWLINE$IF (NOT EXISTS ($NEWLINE$  	SELECT 0$NEWLINE$    FROM #ActDropTableRecord$NEWLINE$    WHERE TableName = @TableName AND PKFieldName = @FieldName AND ID = @ID$NEWLINE$	) and not exists (select 'x' from #ExceptionTable e where e.TableName = @TableName))$NEWLINE$	INSERT INTO #ActDropTableRecord(TableName, PKFieldName, ID)$NEWLINE$	VALUES (@TableName, @FieldName, @ID)    $NEWLINE$    $NEWLINE$DELETE$NEWLINE$FROM #CallStackDropTableRecord$NEWLINE$WHERE TableName = @TableName AND ID = @ID       $NEWLINE$$NEWLINE$IF @IsEntryPoint = 1$NEWLINE$BEGIN$NEWLINE$   $NEWLINE$    SELECT @DepCount = COUNT(*)$NEWLINE$    FROM #ActDropTableRecord$NEWLINE$    $NEWLINE$    SET @CurrentDepIndex = 0$NEWLINE$    SET @Progress = 0;$NEWLINE$    $NEWLINE$    SET @cur = CURSOR FOR$NEWLINE$        SELECT t.TableName, t.PKFieldName, t.ID$NEWLINE$        FROM #ActDropTableRecord t $NEWLINE$		left join #ExceptionTable et on et.TableName = t.TableName$NEWLINE$		where$NEWLINE$			 et.TableName is null$NEWLINE$        ORDER BY RecID$NEWLINE$$NEWLINE$    OPEN @cur$NEWLINE$$NEWLINE$    FETCH NEXT FROM @cur $NEWLINE$    INTO @cTableName, @cPKFieldName, @cID$NEWLINE$$NEWLINE$    WHILE @@FETCH_STATUS = 0$NEWLINE$    BEGIN$NEWLINE$        PRINT 'Deleting from [' + @cTableName + '], ID = ''' + CAST(@cID AS varchar(128)) + ''''$NEWLINE$        SET @Script = 'DELETE FROM [' + @cTableName + '] WHERE '$NEWLINE$        	+ @cPKFieldName + ' = ''' + CAST(@cID AS varchar(128)) + ''''$NEWLINE$        EXEC(@Script)$NEWLINE$        $NEWLINE$        /* Logging*/$NEWLINE$        SET @CurrentDepIndex = @CurrentDepIndex + 1$NEWLINE$        SET @Progress = ROUND((CAST(@CurrentDepIndex AS numeric(15, 0)) / @DepCount) * 100, 0)$NEWLINE$$NEWLINE$        FETCH NEXT FROM @cur $NEWLINE$        INTO @cTableName, @cPKFieldName, @cID$NEWLINE$    END$NEWLINE$$NEWLINE$    CLOSE @cur$NEWLINE$    DEALLOCATE @cur    $NEWLINE$    $NEWLINE$	DROP TABLE #ActDropTableRecord$NEWLINE$	DROP TABLE #TmpDropTableRecord$NEWLINE$    DROP TABLE #CallStackDropTableRecord$NEWLINE$END$NEWLINE$$NEWLINE$END$NEWLINE$$NEWLINE$GO$NEWLINE$",0,0
mMSSQLIDE.dll\mMSSQLExec.dll
{67D8142E-B8BE-4BC3-91FD-B63EC3F054F5}


FALSE
{547BB9FB-6E5A-4D7F-ACA7-2DFE0AB54E01}
Kayflow Client
http://www.solnake.com/Kayflow Client.7zip
FALSE
{46D716DB-8E10-4E68-845B-2D7BA1504695}
Microsoft Windows Installer 3.1
http://www.mywebsite.com/Microsoft Windows Installer 3.1.7zip
FALSE
{557271C4-AECC-47ED-921E-4272F269F2DB}
Kayflow DB Server
http://www.solnake.com/Kayflow DB Server.7zip
FALSE
{EDB64F22-1428-43F3-99A6-A73B65A02689}
Kayflow DB Server
http://www.solnake.com/Kayflow DB Server.7zip
FALSE
{CC375DED-A7EB-4107-A66C-31539EEFB187}
Kayflow DB Server
http://www.solnake.com/Kayflow DB Server.7zip
FALSE
{99B0B55F-68EE-4D47-A97A-9A35805DE091}
Microsoft Windows Installer 4.5 (x64)
http://www.solnake.com/Microsoft Windows Installer 4.5 (x64).7zip
FALSE
{92BBD091-C74A-4FAB-BBDF-5DB382FF1C58}
Microsoft .NET Framework 2.0 with Service Pack 2 (x64)
http://www.solnake.com/Microsoft .NET Framework 2.0 with Service Pack 2 (x64).7zip
FALSE
{3A7CA02C-037B-42DA-B953-288984635A3D}
Microsoft .NET Framework Client 4 (x64)
http://www.solnake.com/Microsoft .NET Framework Client 4 (x64).7zip
FALSE
{6A848332-44E8-478B-9D30-37BCA3EC10A3}
Microsoft .NET Framework 4 (x64)
http://www.solnake.com/Microsoft .NET Framework 4 (x64).7zip
FALSE
{5E55CD9B-DF99-42B1-9728-58B79556B55C}
Kayflow Server
http://www.solnake.com/Kayflow Server.7zip
FALSE
{1CA462E6-0345-4A9C-A9A2-3FCAE5A48573}
Microsoft SQL Server Express 2008 R2 (x64)
http://www.solnake.com/Microsoft SQL Server Express 2008 R2 (x64).7zip
FALSE
{AD29C018-75A8-4642-9551-C0EAB47AA5CE}
Microsoft Windows Installer 4.5
http://www.solnake.com/Microsoft Windows Installer 4.5.7zip
FALSE
{5F34B2D8-FB5F-4164-9CF5-F18A1B662B1C}
Microsoft .NET Framework 2.0 with Service Pack 2
http://www.solnake.com/Microsoft .NET Framework 2.0 with Service Pack 2.7zip
FALSE
{867159BE-1B8C-4CF1-B8C1-94E610D1AAC4}
Microsoft SQL Server Express 2008 R2 (x86)
http://www.solnake.com/Microsoft SQL Server Express 2008 R2 (x86).7zip
FALSE
{F2E84EF8-E882-46E6-9ABE-891926BCA930}
Microsoft .NET Framework Client 4
http://www.solnake.com/Microsoft .NET Framework Client 4.7zip
FALSE
{158BC420-5E72-44CE-A2DC-BA0386A68A96}
Microsoft .NET Framework 4
http://www.solnake.com/Microsoft .NET Framework 4.7zip
FALSE
{3C65B346-2CE1-467C-91C3-BE9C0C135272}
Welcome Dialog
{C2245A8F-395E-4D49-AF41-6B995B6BC349}
License Check
{08A23460-CFEC-40BE-834B-6B8AB7A66BD3}
ReadMe Information
{0882B0A0-1A75-4B7A-A264-904131B268D3}
User Registration
{8412A46F-1B42-4EED-9365-81796F6EA0DA}
Setup Type
{2CDAD5D6-E5D4-4ABD-A7E6-513A9D7EE3EC}
Custom Setup
{0360AE00-70A5-49F0-8CE2-603C531DA51A}
Destination Directory
{4E947B51-9CD8-4899-B218-905D840B5E08}
Start Menu
{26965319-C802-4C18-A049-A8BCBD7F0BB7}
Start Installation
{1A85D9B7-6162-41E3-98BA-1C57BA525288}
Maintenance
{873573BF-CA60-4079-AC6C-03A8AF1FDBC9}
Main Install
{67780C6A-1812-4E8D-9805-1AA495997A76}
mainprocess
{174E2598-A14C-4720-B92F-E16601DE8F87}
prereq
{9B7B44A8-3F31-4B8E-8424-602DCA3138C8}
Maintenance
{8479925B-7CE6-411C-AED9-E850F6283262}
Main Install
{29F173AD-8856-440C-BCB9-7C4B7D847B3A}
Welcome Dialog
{5C198BB7-8D76-4DF8-AEF3-234C16406D76}
Main Install
{C1A69B15-A05C-4892-8208-434F6BD83E66}
License Check
{8D011262-BAB6-4A04-B9C4-9389A22DAE8B}
Main Install
{ADCBF0AF-781D-4B57-BEA1-7CCBC57C0D29}
ReadMe Information
{AD39150E-83AF-484D-A709-FEE89D267C19}
Main Install
{C6FC307B-BDEF-4B8D-9694-DDFB3C0FC423}
User Registration
{A139B289-A928-41DD-B8DF-721C183018E8}
Main Install
{53174ED0-D6F7-4112-85BB-1F15BFEA41B6}
Setup Type
{94CE1D3E-31A3-49D2-9342-BA50FCB573B4}
Main Install
{E2A0CA5E-B2B7-4FF5-A7CF-AE522F9318B7}
Custom Setup
{06D7C51C-2911-4170-82AF-CFEDEBAFA062}
Main Install
{4B286534-89CD-4A41-80DB-29851A754EC3}
Destination Directory
{82AD749A-15F8-4E72-A05D-545418F9079F}
Main Install
{09560685-7210-4589-BCCE-3AFE1C7E5CCB}
Start Menu
{3AE3B77A-1DF6-4F40-9C8C-EFB3E7CE0D05}
Welcome Dialog
{69E5F0D1-0A1D-4730-8014-67E89D22A303}
Main Install
{22790FBB-C1F8-466B-967C-9ED0FDB8A0DB}
mainprocess
{FCED9E24-6CAA-48D6-87DF-198949137E82}
prereq
{954AABE5-724A-40D8-91E4-32C21FD4A999}
prereq
{B76B10B6-2B16-4AF8-BD5A-CF8C7F484F01}
Destination Directory
{E6B00FDE-3209-4245-AE35-C986864DD8C0}
SUCCESS
{C6F54FCE-3880-470E-9428-6756901A6FC8}
TRUE
Check Application Requirements
{B37E8D3C-5B33-49A1-B45C-3F99CFCBAFE1}
FALSE

{A7B78857-BA77-489C-BDAA-57B5195A7A3F}
TRUE
Define Setup Globals
{DCAB2EC0-F475-4675-B652-3E5325A4DFAC}
FALSE

{C0F4EA2F-7785-4C00-A3CA-1CA80B710FA8}
TRUE
Setup User Interview
{A8A33330-FB07-46FE-B6F3-0AE06D913F3E}
FALSE

{A379953D-7F91-4BDE-9D98-747D04DCF432}
TRUE
Process (Un)Installation
{AE448B68-2010-4C56-B7A6-D5E6239AE1C7}
TRUE
Perform Uninstallation
{47515BE9-CE96-431E-B2A7-3A64BA52FB05}
FALSE

{EC6F1653-ED42-4C81-B458-139A0794705E}
TRUE
Perform First Time or Maintenance Installation
{0C6F3D70-3AF2-45A7-9EE2-94085F62BB86}
FALSE

{03F23362-5475-4B70-A556-1C8D504E2AB2}
FALSE

{F78CAE2B-6E5D-4EA3-9860-9E922BA20CC7}
FALSE
Copy of 
{1C10C8E5-9720-4058-A929-2289098EB32F}
TRUE
Finish Setup
{AD5551D4-41F5-484F-9909-2CE6E9740F97}
FALSE
Copy of Copy of 
{22D6BD75-F814-42F3-A43C-1AF9F6425DED}
FALSE
Copy of Copy of Copy of 
{B5D8B434-CC05-4D81-B859-0491F832E933}
TRUE
Install Application Pre-Requisites
{10079D54-AA1F-4FAC-B112-2854EB4EA88B}
FALSE
Copy of Copy of Copy of Copy of 
{60AFFCD3-CD57-41B9-83D6-EE8DE765ED05}
TRUE
Check Application Pre-Requisites
{0A59C938-16CA-42E1-B59D-91A6748D8C8B}
TRUE
Check/Install Application Pre-Requisites
{8FE60F7A-1477-4E26-A84C-711867D7C3E9}
setupmsi31
{71B2885B-CF14-4A21-9653-90784F426969}
setupmsi45_x64
{88CD9AC1-C903-4BA0-ADB9-31A7D43D2C09}
setupnet20sp2_x64
{8DE23E78-79ED-4799-88A2-F40AE7A686AD}
setupnet4aip_client_x64
{5451B114-E7A1-4729-940B-6D96F225A37C}
setupnet4aip_x64
{9AAE3148-2B3D-4EE8-ABBC-33C6DFC20800}
setupsql2008r2_x64
{ABF21893-5283-4988-8052-FEA4EEE2B95D}
setupmsi45
{A4550364-49D0-434E-ACA1-A8F4D8EF1540}
setupnet2sp2
{86B0FA72-F5FE-4332-A0AD-96644D84213F}
setupsql2008r2_x86
{663C87B4-3BE0-4199-80ED-E8B5B32B88F1}
setupnet4aip_client_x86
{FB647C04-9BCD-45F2-BA69-7770A2FC1155}
setupnet4aip_x86
{56E3FC3F-7983-49EB-8687-3207F487E83B}
checkmsi45_x64
{7840A11A-DF32-40EC-8CBD-8766BEFC18ED}
checknet20sp2_x64
{7038CD66-8AB4-4446-8C4F-39121DFA60F0}
checksql2008r2_x64
{97EFC3CE-38D0-4FFE-B027-B1A38C951C55}
checkmsi31
{52F73CCB-8B96-4193-AE30-653BCE9CB80E}
checknet4aip_client_x64
{3F756C5D-B5A1-4ACB-AC58-D3EDDE26DA29}
checknet4aip_x64
{E103A153-29A1-4B79-8610-B846AC963A5A}
checkmsi45
{5076CE5F-FFCF-4767-A57B-22790961D758}
checknet2sp2
{CAC72F59-8DDB-4794-8446-10B1E682FD41}
checksql2008r2_x86
{60211926-F64C-4258-874C-E73A23F0B39B}
checknet4aip_client_x86
{0642013C-9A18-4C1C-B870-7E4BFD1EF5AA}
checknet4aip_x86
{14157B79-8B34-4379-95F7-4A81CA0DAEF6}
checkmsi31
$

























































































































































C








C








C











































































C
C









































































































































$


































































































































































































































































































































































































$
